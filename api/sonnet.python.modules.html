
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>sonnet.python.modules package &#8212; sonnet git documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sonnet-python-modules-package">
<h1>sonnet.python.modules package<a class="headerlink" href="#sonnet-python-modules-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="sonnet.python.modules.nets.html">sonnet.python.modules.nets package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#module-sonnet.python.modules.nets.alexnet">sonnet.python.modules.nets.alexnet module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#sonnet-python-modules-nets-alexnet-test-module">sonnet.python.modules.nets.alexnet_test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#module-sonnet.python.modules.nets.convnet">sonnet.python.modules.nets.convnet module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#sonnet-python-modules-nets-convnet-test-module">sonnet.python.modules.nets.convnet_test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#module-sonnet.python.modules.nets.dilation">sonnet.python.modules.nets.dilation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#sonnet-python-modules-nets-dilation-test-module">sonnet.python.modules.nets.dilation_test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#module-sonnet.python.modules.nets.mlp">sonnet.python.modules.nets.mlp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#sonnet-python-modules-nets-mlp-test-module">sonnet.python.modules.nets.mlp_test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sonnet.python.modules.nets.html#module-sonnet.python.modules.nets">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.attention">
<span id="sonnet-python-modules-attention-module"></span><h2>sonnet.python.modules.attention module<a class="headerlink" href="#module-sonnet.python.modules.attention" title="Permalink to this headline">¶</a></h2>
<p>Modules for attending over memory.</p>
<dl class="class">
<dt id="sonnet.python.modules.attention.AttentionOutput">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.attention.</code><code class="descname">AttentionOutput</code><span class="sig-paren">(</span><em>read</em>, <em>weights</em>, <em>weight_logits</em><span class="sig-paren">)</span><a class="headerlink" href="#sonnet.python.modules.attention.AttentionOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="sonnet.python.modules.attention.AttentionOutput.read">
<code class="descname">read</code><a class="headerlink" href="#sonnet.python.modules.attention.AttentionOutput.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.attention.AttentionOutput.weight_logits">
<code class="descname">weight_logits</code><a class="headerlink" href="#sonnet.python.modules.attention.AttentionOutput.weight_logits" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.attention.AttentionOutput.weights">
<code class="descname">weights</code><a class="headerlink" href="#sonnet.python.modules.attention.AttentionOutput.weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.attention.AttentiveRead">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.attention.</code><code class="descname">AttentiveRead</code><span class="sig-paren">(</span><em>attention_logit_mod</em>, <em>name='attention'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/attention.html#AttentiveRead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.attention.AttentiveRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>A module for reading with attention.</p>
<p>This module reads a weighted sum of embeddings from memory, where each
memory slot’s weight is based on the logit returned by an attention
embedding module. A mask may be given to ignore some memory slots (e.g.
when attending over variable-length sequences).</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-attention-test-module">
<h2>sonnet.python.modules.attention_test module<a class="headerlink" href="#sonnet-python-modules-attention-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.base">
<span id="sonnet-python-modules-base-module"></span><h2>sonnet.python.modules.base module<a class="headerlink" href="#module-sonnet.python.modules.base" title="Permalink to this headline">¶</a></h2>
<p>Base class for TensorFlow snt.</p>
<p>This file contains the Abstract Base Class for defining Modules in
TensorFlow. A Module is an object that can be connected into the Graph
multiple times using the <strong>call</strong> method, sharing variables
automatically with no need to explicitly use scopes or specify
reuse=True.</p>
<dl class="class">
<dt id="sonnet.python.modules.base.AbstractModule">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.base.</code><code class="descname">AbstractModule</code><span class="sig-paren">(</span><em>_sentinel=None</em>, <em>custom_getter=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#AbstractModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Superclass for Sonnet Modules.</p>
<p>This class defines the functionality that every module should implement,
principally the <code class="docutils literal notranslate"><span class="pre">build</span></code> method which is wrapped using
<code class="docutils literal notranslate"><span class="pre">tf.make_template</span></code> and called from <code class="docutils literal notranslate"><span class="pre">__call__</span></code>. Every time the module
is called it will be connected into the graph but using the same shared
set of variables, thanks to the template.</p>
<p>For this to work correctly, the <code class="docutils literal notranslate"><span class="pre">build</span></code> implementation in the derived
class must access all variables using <code class="docutils literal notranslate"><span class="pre">tf.get_variable</span></code>, not
<code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>. The same set of variables must be created each time, if
this is not the case an Error will be raised.</p>
<p>Every subclass must call this class’ <code class="docutils literal notranslate"><span class="pre">__init__</span></code> at the start of their
<code class="docutils literal notranslate"><span class="pre">__init__</span></code>, passing the relevant name. If this step is omitted
variable sharing will not work.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.connected_subgraphs">
<code class="descname">connected_subgraphs</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.connected_subgraphs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the subgraphs created by this module so far.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.base.AbstractModule.get_all_variables">
<code class="descname">get_all_variables</code><span class="sig-paren">(</span><em>collection='trainable_variables'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#AbstractModule.get_all_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.get_all_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>s used when the module is connected.</p>
<p>See the documentation for <code class="docutils literal notranslate"><span class="pre">AbstractModule._capture_variables()</span></code> for
more information.</p>
<p>Args: collection: Collection to restrict query to. By default this is
<code class="docutils literal notranslate"><span class="pre">tf.Graphkeys.TRAINABLE_VARIABLES</span></code>, which doesn’t include
non-trainable variables such as moving averages.</p>
<p>Returns: A sorted (by variable name) tuple of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code> objects.</p>
<p>Raises: NotConnectedError: If the module is not connected to the Graph.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.base.AbstractModule.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#AbstractModule.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>This provides the user with a way of knowing the initializer keys that
are available without having to instantiate a sonnet module. Subclasses
may override this class method if they need additional arguments to
determine what initializer keys may be provided.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.base.AbstractModule.get_variables">
<code class="descname">get_variables</code><span class="sig-paren">(</span><em>collection='trainable_variables'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#AbstractModule.get_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.get_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns tuple of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>s declared inside this module.</p>
<p>Note that this operates by searching this module’s variable scope, and
so does not know about any modules that were constructed elsewhere but
used inside this module.</p>
<p>This method explicitly re-enters the Graph which this module has been
connected to.</p>
<p>Args: collection: Collection to restrict query to. By default this is
<code class="docutils literal notranslate"><span class="pre">tf.Graphkeys.TRAINABLE_VARIABLES</span></code>, which doesn’t include
non-trainable variables such as moving averages.</p>
<p>Returns: A tuple of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code> objects.</p>
<p>Raises: NotConnectedError: If the module is not connected to the Graph.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.graph">
<code class="descname">graph</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Graph instance which the module is connected to, or None.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.is_connected">
<code class="descname">is_connected</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.is_connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true iff the Module been connected to the Graph at least once.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.last_connected_subgraph">
<code class="descname">last_connected_subgraph</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.last_connected_subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the last subgraph created by this module.</p>
<p>Returns: The last connected subgraph.</p>
<p>Raises: NotConnectedError: If the module is not connected to the Graph.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.module_name">
<code class="descname">module_name</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.module_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the Module.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.name_scopes">
<code class="descname">name_scopes</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.name_scopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of all name_scopes generated by this module.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.scope_name">
<code class="descname">scope_name</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.scope_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the full name of the Module’s variable scope.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base.AbstractModule.variable_scope">
<code class="descname">variable_scope</code><a class="headerlink" href="#sonnet.python.modules.base.AbstractModule.variable_scope" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the variable_scope declared by the module.</p>
<p>It is valid for library users to access the internal templated
variable_scope, but only makes sense to do so after connection.
Therefore we raise an error here if the variable_scope is requested
before connection.</p>
<p>The only case where it does make sense to access the variable_scope
before connection is to get the post-uniquification name, which we
support using the separate .scope_name property.</p>
<p>Returns: variable_scope: <code class="docutils literal notranslate"><span class="pre">tf.VariableScope</span></code> instance of the internal
<code class="docutils literal notranslate"><span class="pre">tf.Template</span></code>.</p>
<p>Raises: NotConnectedError: If the module is not connected to the Graph.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.base.Module">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.base.</code><code class="descname">Module</code><span class="sig-paren">(</span><em>build</em>, <em>custom_getter=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#Module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.Module" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Module wrapping a function provided by the user.</p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.base.Transposable">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.base.</code><code class="descname">Transposable</code><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#Transposable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.Transposable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Transposable module interface.</p>
<p>The Transposable interface requires that transposable modules implement
a method called <code class="docutils literal notranslate"><span class="pre">transpose</span></code>, returning a module that is the transposed
version of the one the method is called on. Calling the method twice
should return a module with the same specifications as the original
module.</p>
<p>When implementing a transposable module, special care is required to
make sure that parameters needed to instantiate the module are provided
as functions whose invocation is deferred to graph construction time.</p>
<p>For example, in Linear we might want to call:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">linear</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="n">output_size</span><span class="p">)</span>
<span class="n">linear_transpose</span> <span class="o">=</span> <span class="n">linear</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
<p>where the output_size for linear_transpose is not known yet, as linear
is not yet connected to the graph: output_size is passed to
linear_transpose’s constructor as a lambda returning
linear.input_size. The lambda will return the correct value once linear
is given an input. Notice that linear_transpose’s output_size value
does not need to be defined until the module is connected to the graph.</p>
<dl class="method">
<dt id="sonnet.python.modules.base.Transposable.input_shape">
<code class="descname">input_shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#Transposable.input_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.Transposable.input_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns shape of input <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> passed at last call to <code class="docutils literal notranslate"><span class="pre">build</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.base.Transposable.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/base.html#Transposable.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base.Transposable.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds and returns transposed version of module.</p>
<p>Args: name: Name of the transposed module. **kwargs: Additional Python
flags controlling transposition.</p>
<p>Returns: Transposed version of the module.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sonnet.python.modules.base_errors">
<span id="sonnet-python-modules-base-errors-module"></span><h2>sonnet.python.modules.base_errors module<a class="headerlink" href="#module-sonnet.python.modules.base_errors" title="Permalink to this headline">¶</a></h2>
<p>Sonnet exception classes.</p>
<dl class="exception">
<dt id="sonnet.python.modules.base_errors.DifferentGraphError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">DifferentGraphError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#DifferentGraphError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.DifferentGraphError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when trying to connect a Sonnet module to multiple Graphs.</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.Error">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">Error</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">exceptions.Exception</span></code></p>
<p>Base class for all errors from snt.</p>
<p>This is thrown to indicate a Neural Network specific problem, e.g. wrong
module arity, module is not connected to the graph when it should be,
tried to wire together incompatible modules, etc.</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.IncompatibleShapeError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">IncompatibleShapeError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#IncompatibleShapeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.IncompatibleShapeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when the shape of the input at build time is incompatible.</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.ModuleInfoError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">ModuleInfoError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#ModuleInfoError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.ModuleInfoError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when Sonnet <code class="docutils literal notranslate"><span class="pre">ModuleInfo</span></code> cannot be serialized.</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.NotConnectedError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">NotConnectedError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#NotConnectedError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.NotConnectedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when operating on a module that has not yet been connected.</p>
<p>Some module properties / methods are valid to access before the module
has been connected into the graph, but some are not. This Error is
raised when the user attempts to do anything not valid before
connection.</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.NotInitializedError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">NotInitializedError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#NotInitializedError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.NotInitializedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when connecting an uninitialized Sonnet module.</p>
<p>Before they can be connected, all Sonnet modules must call
<code class="docutils literal notranslate"><span class="pre">AbstractModule.__init__</span></code> (e.g. via a <code class="docutils literal notranslate"><span class="pre">super</span></code> call).</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.NotSupportedError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">NotSupportedError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#NotSupportedError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.NotSupportedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when something that cannot be supported is requested.</p>
<p>For example a Dilated Convolution module cannot be transposed.</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.ParentNotBuiltError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">ParentNotBuiltError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#ParentNotBuiltError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.ParentNotBuiltError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when the parent of a module has not been built yet.</p>
<p>For example, when making a transpose of modules that inherit from
<code class="docutils literal notranslate"><span class="pre">module.Transposable</span></code>, the parent has to be connected to the graph
before the child transpose to ensure that shape inference has already
occurred.</p>
</dd></dl>

<dl class="exception">
<dt id="sonnet.python.modules.base_errors.UnderspecifiedError">
<em class="property">exception </em><code class="descclassname">sonnet.python.modules.base_errors.</code><code class="descname">UnderspecifiedError</code><a class="reference internal" href="../_modules/sonnet/python/modules/base_errors.html#UnderspecifiedError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.base_errors.UnderspecifiedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base_errors.Error" title="sonnet.python.modules.base_errors.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base_errors.Error</span></code></a></p>
<p>Error raised when too little information is available.</p>
<p>This does not typically mean the user is trying to do something that
doesn’t work (in which case <code class="docutils literal notranslate"><span class="pre">IncompatibleShapeError</span></code> should be used),
just that some more information needs to be provided in order to build
the Graph.</p>
</dd></dl>

</div>
<div class="section" id="module-sonnet.python.modules.base_info">
<span id="sonnet-python-modules-base-info-module"></span><h2>sonnet.python.modules.base_info module<a class="headerlink" href="#module-sonnet.python.modules.base_info" title="Permalink to this headline">¶</a></h2>
<p>Sonnet module information, stored in the graph collections.</p>
<dl class="class">
<dt id="sonnet.python.modules.base_info.ConnectedSubGraph">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.base_info.</code><code class="descname">ConnectedSubGraph</code><span class="sig-paren">(</span><em>module</em>, <em>name_scope</em>, <em>inputs</em>, <em>outputs</em><span class="sig-paren">)</span><a class="headerlink" href="#sonnet.python.modules.base_info.ConnectedSubGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ConnectedSubGraph.inputs">
<code class="descname">inputs</code><a class="headerlink" href="#sonnet.python.modules.base_info.ConnectedSubGraph.inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ConnectedSubGraph.module">
<code class="descname">module</code><a class="headerlink" href="#sonnet.python.modules.base_info.ConnectedSubGraph.module" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ConnectedSubGraph.name_scope">
<code class="descname">name_scope</code><a class="headerlink" href="#sonnet.python.modules.base_info.ConnectedSubGraph.name_scope" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ConnectedSubGraph.outputs">
<code class="descname">outputs</code><a class="headerlink" href="#sonnet.python.modules.base_info.ConnectedSubGraph.outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.base_info.ModuleInfo">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.base_info.</code><code class="descname">ModuleInfo</code><span class="sig-paren">(</span><em>module_name</em>, <em>scope_name</em>, <em>class_name</em>, <em>connected_subgraphs</em><span class="sig-paren">)</span><a class="headerlink" href="#sonnet.python.modules.base_info.ModuleInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ModuleInfo.class_name">
<code class="descname">class_name</code><a class="headerlink" href="#sonnet.python.modules.base_info.ModuleInfo.class_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ModuleInfo.connected_subgraphs">
<code class="descname">connected_subgraphs</code><a class="headerlink" href="#sonnet.python.modules.base_info.ModuleInfo.connected_subgraphs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ModuleInfo.module_name">
<code class="descname">module_name</code><a class="headerlink" href="#sonnet.python.modules.base_info.ModuleInfo.module_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.base_info.ModuleInfo.scope_name">
<code class="descname">scope_name</code><a class="headerlink" href="#sonnet.python.modules.base_info.ModuleInfo.scope_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-base-info-test-module">
<h2>sonnet.python.modules.base_info_test module<a class="headerlink" href="#sonnet-python-modules-base-info-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="sonnet-python-modules-base-test-module">
<h2>sonnet.python.modules.base_test module<a class="headerlink" href="#sonnet-python-modules-base-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.basic">
<span id="sonnet-python-modules-basic-module"></span><h2>sonnet.python.modules.basic module<a class="headerlink" href="#module-sonnet.python.modules.basic" title="Permalink to this headline">¶</a></h2>
<p>Basic Modules for TensorFlow snt.</p>
<p>Modules defining the simplest building blocks for Neural Networks.</p>
<dl class="class">
<dt id="sonnet.python.modules.basic.AddBias">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">AddBias</code><span class="sig-paren">(</span><em>output_shape=None</em>, <em>bias_dims=None</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>name='add'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#AddBias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.AddBias" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>AddBias module.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.basic.AddBias.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['b'])</em><a class="headerlink" href="#sonnet.python.modules.basic.AddBias.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.AddBias.b">
<code class="descname">b</code><a class="headerlink" href="#sonnet.python.modules.basic.AddBias.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing the bias.</p>
<p>Returns: Variable object containing the bias, from the most recent
<strong>call</strong>.</p>
<p>Raises: base.NotConnectedError: If the module has not been connected to
the graph yet, meaning the variables do not exist.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.AddBias.input_shape">
<code class="descname">input_shape</code><a class="headerlink" href="#sonnet.python.modules.basic.AddBias.input_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns shape of input <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> passed at last call to <code class="docutils literal notranslate"><span class="pre">build</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.basic.AddBias.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#AddBias.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.AddBias.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns transposed <code class="docutils literal notranslate"><span class="pre">AddBias</span></code> module.</p>
<p>Args: name: Optional string assigning name of transpose module. The
default name is constructed by appending “_transpose” to
<code class="docutils literal notranslate"><span class="pre">self.module_name</span></code>.</p>
<p>Returns: Transposed <code class="docutils literal notranslate"><span class="pre">AddBias</span></code> module.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.BatchApply">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">BatchApply</code><span class="sig-paren">(</span><em>module_or_op</em>, <em>n_dims=2</em>, <em>input_example_index=0</em>, <em>name='batch_apply'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#BatchApply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.BatchApply" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Merges a number of leading dimensions of an input tensor to manipulate
it.</p>
<p>Merges a number of leading dimensions of a tensor into a single
dimension, connects the provided module, then splits the leading
dimension of the result to match the input.</p>
<p>Input tensors whose rank is smaller than the number of dimensions to
collapse (e.g. all scalar values, which are tensors of rank 0), are
passed unaltered to the provided module.</p>
<p>This is useful for applying some module to each timestep of a Time x
Batch x N tensor. If a module is hard coded to only support 2D (Batch x
N) then the full 3D Tensor cannot be provided. BatchApply will ‘merge’
the first two dimensions of the sequence tensor by reshaping to a (Time
* Batch) x N Tensor, and then the internal module can be applied. The
result of that operation is reshaped such that its first dimensions are
split to match the leading dimensions of the input.</p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.BatchFlatten">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">BatchFlatten</code><span class="sig-paren">(</span><em>preserve_dims=1</em>, <em>name='batch_flatten'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#BatchFlatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.BatchFlatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.basic.BatchReshape" title="sonnet.python.modules.basic.BatchReshape"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.basic.BatchReshape</span></code></a></p>
<p>Flattens the input Tensor, preserving the batch dimension(s).</p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.BatchReshape">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">BatchReshape</code><span class="sig-paren">(</span><em>shape</em>, <em>preserve_dims=1</em>, <em>name='batch_reshape'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#BatchReshape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.BatchReshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>Reshapes input Tensor, preserving the batch dimension.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.basic.BatchReshape.input_shape">
<code class="descname">input_shape</code><a class="headerlink" href="#sonnet.python.modules.basic.BatchReshape.input_shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.basic.BatchReshape.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#BatchReshape.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.BatchReshape.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns transpose batch reshape.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.FlattenTrailingDimensions">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">FlattenTrailingDimensions</code><span class="sig-paren">(</span><em>dim_from</em>, <em>name='batch_dim_from'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#FlattenTrailingDimensions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.FlattenTrailingDimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.basic.BatchReshape" title="sonnet.python.modules.basic.BatchReshape"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.basic.BatchReshape</span></code></a></p>
<p>Flattens trailing dimensions of a Tensor.</p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.Linear">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">Linear</code><span class="sig-paren">(</span><em>output_size</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>custom_getter=None</em>, <em>name='linear'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#Linear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.Linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>Linear module, optionally including bias.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.b">
<code class="descname">b</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing the bias.</p>
<p>Returns: Variable object containing the bias, from the most recent
<strong>call</strong>.</p>
<p>Raises: base.NotConnectedError: If the module has not been connected to
the graph yet, meaning the variables do not exist. AttributeError: If
the module does not use bias.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.basic.Linear.clone">
<code class="descname">clone</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#Linear.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.Linear.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a cloned <code class="docutils literal notranslate"><span class="pre">Linear</span></code> module.</p>
<p>Args: name: Optional string assigning name of cloned module. The default
name is constructed by appending “_clone” to <code class="docutils literal notranslate"><span class="pre">self.module_name</span></code>.</p>
<p>Returns: Cloned <code class="docutils literal notranslate"><span class="pre">Linear</span></code> module.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.basic.Linear.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>use_bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#Linear.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.Linear.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>This provides the user with a way of knowing the initializer keys that
are available without having to instantiate a sonnet module. Subclasses
may override this class method if they need additional arguments to
determine what initializer keys may be provided.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.has_bias">
<code class="descname">has_bias</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.has_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if bias Variable is present in the module.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.initializers">
<code class="descname">initializers</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.initializers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the initializers dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.input_shape">
<code class="descname">input_shape</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.input_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns shape of input <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> passed at last call to <code class="docutils literal notranslate"><span class="pre">build</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the module output size.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.partitioners">
<code class="descname">partitioners</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.partitioners" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the partitioners dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.regularizers">
<code class="descname">regularizers</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.regularizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the regularizers dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.basic.Linear.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#Linear.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.Linear.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns transposed <code class="docutils literal notranslate"><span class="pre">Linear</span></code> module.</p>
<p>Args: name: Optional string assigning name of transpose module. The
default name is constructed by appending “_transpose” to
<code class="docutils literal notranslate"><span class="pre">self.module_name</span></code>.</p>
<p>Returns: Transposed <code class="docutils literal notranslate"><span class="pre">Linear</span></code> module.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.Linear.w">
<code class="descname">w</code><a class="headerlink" href="#sonnet.python.modules.basic.Linear.w" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing the weight matrix.</p>
<p>Returns: Variable object containing the weights, from the most recent
<strong>call</strong>.</p>
<p>Raises: base.NotConnectedError: If the module has not been connected to
the graph yet, meaning the variables do not exist.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.MergeDims">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">MergeDims</code><span class="sig-paren">(</span><em>start</em>, <em>size</em>, <em>name='merge_dims'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#MergeDims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.MergeDims" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Merges a tensor or nested list of tensors along a range of dimensions.</p>
<p>Tensors are reshaped by specifying the range of dimensions to merge.
Hence, the reshape can be performed without knowing in advance the rank
of the input tensor.</p>
<p>For example, merging dimensions 1, 2 and 3 together can be performed by
calling:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">MergeDims</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>A nested list of tensors can be merged:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])]]</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">MergeDims</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.SelectInput">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">SelectInput</code><span class="sig-paren">(</span><em>idx</em>, <em>name='select_input'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#SelectInput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.SelectInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Returns a subset of its inputs in an arbitrarily nested configuration.</p>
<p>This module can be used for multiple purposes.</p>
<p>The basic usage is to select a tensor or a subset of tensors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">SelectInput</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">)(</span><span class="n">input0</span><span class="p">,</span> <span class="n">input1</span><span class="p">)</span>
<span class="o">==&gt;</span> <span class="n">input0</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">SelectInput</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">)(</span><span class="n">input0</span><span class="p">,</span> <span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
<span class="o">==&gt;</span> <span class="p">(</span><span class="n">input0</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
</pre></div>
</div>
<p>Another usage is to change the orders of the input tensors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">SelectInput</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">)(</span><span class="n">input0</span><span class="p">,</span> <span class="n">input1</span><span class="p">)</span>
<span class="o">==&gt;</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input0</span><span class="p">)</span>
</pre></div>
</div>
<p>Another usage is to duplicate an input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">SelectInput</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">)(</span><span class="n">input0</span><span class="p">)</span>
<span class="o">==&gt;</span> <span class="p">(</span><span class="n">input0</span><span class="p">,</span> <span class="n">input0</span><span class="p">)</span>
</pre></div>
</div>
<p>Another usage is to add arbitrary nesting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">SelectInput</span><span class="p">(</span>
    <span class="n">idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">)(</span><span class="n">input0</span><span class="p">,</span> <span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
<span class="o">==&gt;</span> <span class="p">(</span><span class="n">input0</span><span class="p">,</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="p">(</span><span class="n">input2</span><span class="p">,)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.SliceByDim">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">SliceByDim</code><span class="sig-paren">(</span><em>dims</em>, <em>begin</em>, <em>size</em>, <em>name='slice_by_dim'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#SliceByDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.SliceByDim" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Slices a tensor along specific dimensions.</p>
<p>The user can slice a tensor by specifying only the list of dimensions
that they want to slice, together with the lists of integers containing
the beginning indices of the slicing, and the size of the slices. Hence,
with <code class="docutils literal notranslate"><span class="pre">SliceByDim</span></code> slicing can be performed without knowing in advance
the rank of the input tensor.</p>
<p>Tensorflow also offers a built-in op performing slicing, <code class="docutils literal notranslate"><span class="pre">tf.slice</span></code>.
However, <code class="docutils literal notranslate"><span class="pre">tf.slice</span></code> requires all the slicing dimensions to be
specified, using wildcards when no slicing is required. For example,
with <code class="docutils literal notranslate"><span class="pre">tf.slice</span></code>, slicing half a 5D tensor along dimension <code class="docutils literal notranslate"><span class="pre">1</span></code> would
be:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span>
                  <span class="n">begin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_shape</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The same operation using <code class="docutils literal notranslate"><span class="pre">SliceByDim</span></code> would be:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">SliceByDim</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">begin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">get_shape</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">//</span><span class="mi">2</span><span class="p">])(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SliceByDim</span></code> can be used to specify multiple slicing dimensions, for
example:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">SliceByDim</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">begin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">])(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.TileByDim">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">TileByDim</code><span class="sig-paren">(</span><em>dims</em>, <em>multiples</em>, <em>name='tile_by_dim'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#TileByDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.TileByDim" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Tile a tensor along specific dimensions.</p>
<p>The user can tile a tensor by specifying only the list of dimensions
that they want to tile, together with the lists of integers containing
the multiples of the tiling. Hence, with <code class="docutils literal notranslate"><span class="pre">TileByDim</span></code> tiling can be
performed without knowing in advance the rank of the input tensor.</p>
<p>Tensorflow also offers a built-in op performing tiling, <code class="docutils literal notranslate"><span class="pre">tf.tile</span></code>.
However, <code class="docutils literal notranslate"><span class="pre">tf.tile</span></code> requires all the tiling dimensions to be specified,
using <code class="docutils literal notranslate"><span class="pre">1</span></code> when no tiling is required. For example, with tf.tiling,
tiling a 5D tensor along dimension <code class="docutils literal notranslate"><span class="pre">1</span></code>, by <code class="docutils literal notranslate"><span class="pre">2</span></code> would be:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">multiples</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The same operation using <code class="docutils literal notranslate"><span class="pre">TileByDim</span></code> would be:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">TileByDim</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">multiples</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">TileByDim</span></code> can be used to specify multiple tiling dimensions, for
example:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="n">TileByDim</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">multiples</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic.TrainableVariable">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">TrainableVariable</code><span class="sig-paren">(</span><em>shape</em>, <em>dtype=tf.float32</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>custom_getter=None</em>, <em>name='trainable_variable'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#TrainableVariable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.TrainableVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Provides learnable parameter Tensor.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.basic.TrainableVariable.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['w'])</em><a class="headerlink" href="#sonnet.python.modules.basic.TrainableVariable.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic.TrainableVariable.w">
<code class="descname">w</code><a class="headerlink" href="#sonnet.python.modules.basic.TrainableVariable.w" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing the weights Tensor.</p>
<p>Returns: Variable object containing the weights, from the most recent
<strong>call</strong>.</p>
<p>Raises: base.Error: If the module has not been connected to the graph
yet, meaning the variables do not exist.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.basic.calculate_bias_shape">
<code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">calculate_bias_shape</code><span class="sig-paren">(</span><em>input_shape</em>, <em>bias_dims</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#calculate_bias_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.calculate_bias_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <code class="docutils literal notranslate"><span class="pre">bias_shape</span></code> based on the <code class="docutils literal notranslate"><span class="pre">input_shape</span></code> and <code class="docutils literal notranslate"><span class="pre">bias_dims</span></code>.</p>
<p>Args: input_shape: Shape of the input being passed into the module. The
leading dimension is the minibatch size. bias_dims: The dimensions that
bias should be applied over. The remaining dimensions will get
broadcasted over.</p>
<p>Returns: bias_shape: Tuple corresponding to the shape of bias Variable
to create.</p>
<p>Raises: ValueError: If the user attempts to add bias over the minibatch
dimension, e.g. <code class="docutils literal notranslate"><span class="pre">bias_dims=[0]</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.basic.create_bias_initializer">
<code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">create_bias_initializer</code><span class="sig-paren">(</span><em>unused_bias_shape</em>, <em>dtype=tf.float32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#create_bias_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.create_bias_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the biases of a linear/AddBias module.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.basic.create_linear_initializer">
<code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">create_linear_initializer</code><span class="sig-paren">(</span><em>input_size</em>, <em>dtype=tf.float32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#create_linear_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.create_linear_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for weights of a linear module.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.basic.merge_leading_dims">
<code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">merge_leading_dims</code><span class="sig-paren">(</span><em>array_or_tensor</em>, <em>n_dims=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#merge_leading_dims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.merge_leading_dims" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the first dimensions of a tensor.</p>
<p>Args: array_or_tensor: Tensor to have its first dimensions merged. Can
also be an array or numerical value, which will be converted to a tensor
for batch application, if needed. n_dims: Number of dimensions to
merge.</p>
<p>Returns: Either the input value converted to a Tensor, with the
requested dimensions merged, or the unmodified input value if the input
has less than <code class="docutils literal notranslate"><span class="pre">n_dims</span></code> dimensions.</p>
<p>Raises: ValueError: If the rank of <code class="docutils literal notranslate"><span class="pre">array_or_tensor</span></code> is not
well-defined.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.basic.split_leading_dim">
<code class="descclassname">sonnet.python.modules.basic.</code><code class="descname">split_leading_dim</code><span class="sig-paren">(</span><em>tensor</em>, <em>inputs</em>, <em>n_dims=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic.html#split_leading_dim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic.split_leading_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the first dimension of a tensor.</p>
<p>Args: tensor: Tensor to have its first dimension split. inputs: Original
reference input to look the dimensions of. n_dims: Number of dimensions
to split.</p>
<p>Returns: The input tensor, with its first dimension split.</p>
</dd></dl>

</div>
<div class="section" id="module-sonnet.python.modules.basic_rnn">
<span id="sonnet-python-modules-basic-rnn-module"></span><h2>sonnet.python.modules.basic_rnn module<a class="headerlink" href="#module-sonnet.python.modules.basic_rnn" title="Permalink to this headline">¶</a></h2>
<p>Basic RNN Cores for TensorFlow snt.</p>
<p>This file contains the definitions of the simplest building blocks for
Recurrent Neural Networks.</p>
<dl class="class">
<dt id="sonnet.python.modules.basic_rnn.DeepRNN">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic_rnn.</code><code class="descname">DeepRNN</code><span class="sig-paren">(</span><em>cores</em>, <em>skip_connections=True</em>, <em>concat_final_output_if_skip=True</em>, <em>name='deep_rnn'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic_rnn.html#DeepRNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic_rnn.DeepRNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>RNN core that passes data through a number of internal modules or ops.</p>
<p>This module is constructed by passing an iterable of externally
constructed modules or ops. The DeepRNN takes <code class="docutils literal notranslate"><span class="pre">(input,</span> <span class="pre">prev_state)</span></code> as
input and passes the input through each internal module in the order
they were presented, using elements from <code class="docutils literal notranslate"><span class="pre">prev_state</span></code> as necessary for
internal recurrent cores. The output is <code class="docutils literal notranslate"><span class="pre">(output,</span> <span class="pre">next_state)</span></code> in
common with other RNN cores. By default, skip connections from the input
to all internal modules and from each intermediate output to the final
output are used.</p>
<p>E.g.:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lstm1</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="n">hidden_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">lstm2</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="n">hidden_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">deep_rnn</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">DeepRNN</span><span class="p">([</span><span class="n">lstm1</span><span class="p">,</span> <span class="n">lstm2</span><span class="p">])</span>
<span class="n">output</span><span class="p">,</span> <span class="n">next_state</span> <span class="o">=</span> <span class="n">deep_rnn</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">prev_state</span><span class="p">)</span>
</pre></div>
</div>
<p>The computation set up inside the DeepRNN has the same effect as:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prev_state1</span><span class="p">,</span> <span class="n">prev_state2</span> <span class="o">=</span> <span class="n">prev_state</span>
<span class="n">lstm1_output</span><span class="p">,</span> <span class="n">next_state1</span> <span class="o">=</span> <span class="n">lstm1</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">prev_state1</span><span class="p">)</span>
<span class="n">lstm2_output</span><span class="p">,</span> <span class="n">next_state2</span> <span class="o">=</span> <span class="n">lstm2</span><span class="p">(</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="nb">input</span><span class="p">,</span> <span class="n">lstm1_output</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">prev_state2</span><span class="p">)</span>

<span class="n">next_state</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_state1</span><span class="p">,</span> <span class="n">next_state2</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">lstm1_output</span><span class="p">,</span> <span class="n">lstm2_output</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Every internal module receives the preceding module’s output and the
entire core’s input. The output is created by concatenating each
internal module’s output. In the case of internal recurrent elements,
corresponding elements of the state are used such that <code class="docutils literal notranslate"><span class="pre">state[i]</span></code> is
passed to the <code class="docutils literal notranslate"><span class="pre">i</span></code>’th internal recurrent element. Note that the state
of a <code class="docutils literal notranslate"><span class="pre">DeepRNN</span></code> is always a tuple, which will contain the same number
of elements as there are internal recurrent cores. If no internal
modules are recurrent, the state of the DeepRNN as a whole is the empty
tuple. Wrapping non-recurrent modules into a DeepRNN can be useful to
produce something API compatible with a “real” recurrent module,
simplifying code that handles the cores.</p>
<p>Without skip connections the previous example would become the following
(note the only difference is the addition of
<code class="docutils literal notranslate"><span class="pre">skip_connections=False</span></code>):</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ... declare other modules as above</span>
<span class="n">deep_rnn</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">DeepRNN</span><span class="p">([</span><span class="n">lin</span><span class="p">,</span> <span class="n">tanh</span><span class="p">,</span> <span class="n">lstm</span><span class="p">],</span> <span class="n">skip_connections</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">output</span><span class="p">,</span> <span class="n">next_state</span> <span class="o">=</span> <span class="n">deep_rnn</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">prev_state</span><span class="p">)</span>
</pre></div>
</div>
<p>which is equivalent to:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lin_output</span> <span class="o">=</span> <span class="n">lin</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="n">tanh_output</span> <span class="o">=</span> <span class="n">tanh</span><span class="p">(</span><span class="n">lin_output</span><span class="p">)</span>
<span class="n">lstm_output</span><span class="p">,</span> <span class="n">lstm_next_state</span> <span class="o">=</span> <span class="n">lstm</span><span class="p">(</span><span class="n">tanh_output</span><span class="p">,</span> <span class="n">prev_state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">next_state</span> <span class="o">=</span> <span class="p">(</span><span class="n">lstm_next_state</span><span class="p">,)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">lstm_output</span>
</pre></div>
</div>
<p>Note: when using skip connections, all the cores should be recurrent.</p>
<dl class="method">
<dt id="sonnet.python.modules.basic_rnn.DeepRNN.initial_state">
<code class="descname">initial_state</code><span class="sig-paren">(</span><em>batch_size</em>, <em>dtype=tf.float32</em>, <em>trainable=False</em>, <em>trainable_initializers=None</em>, <em>trainable_regularizers=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic_rnn.html#DeepRNN.initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic_rnn.DeepRNN.initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the default start state for a DeepRNN.</p>
<p>Args: batch_size: An int, float or scalar Tensor representing the batch
size. dtype: The data type to use for the state. trainable: Boolean that
indicates whether to learn the initial state. trainable_initializers:
An initializer function or nested structure of functions with same
structure as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code> property of the core, to be used as
initializers of the initial state variable. trainable_regularizers:
Optional regularizer function or nested structure of functions with the
same structure as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code> property of the core, to be used as
regularizers of the initial state variable. A regularizer should be a
function that takes a single <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> as an input and returns a scalar
<code class="docutils literal notranslate"><span class="pre">Tensor</span></code> output, e.g. the L1 and L2 regularizers in
<code class="docutils literal notranslate"><span class="pre">tf.contrib.layers</span></code>. name: Optional string used to prefix the initial
state variable names, in the case of a trainable initial state. If not
provided, defaults to the name of the module.</p>
<p>Returns: A tensor or nested tuple of tensors with same structure and
shape as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code> property of the core.</p>
<p>Raises: ValueError: if the number of passed initializers is not the same
as the number of recurrent cores.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.DeepRNN.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.DeepRNN.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.DeepRNN.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.DeepRNN.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic_rnn.ModelRNN">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic_rnn.</code><code class="descname">ModelRNN</code><span class="sig-paren">(</span><em>model</em>, <em>name='model_rnn'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic_rnn.html#ModelRNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic_rnn.ModelRNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>RNNCore that ignores input and uses a model to compute its next state.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.ModelRNN.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.ModelRNN.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.ModelRNN.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.ModelRNN.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.basic_rnn.</code><code class="descname">VanillaRNN</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>activation=&lt;function tanh&gt;</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>name='vanilla_rnn'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/basic_rnn.html#VanillaRNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Basic fully connected vanilla RNN core.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.HIDDEN_TO_HIDDEN">
<code class="descname">HIDDEN_TO_HIDDEN</code><em class="property"> = 'hidden_to_hidden'</em><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.HIDDEN_TO_HIDDEN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.IN_TO_HIDDEN">
<code class="descname">IN_TO_HIDDEN</code><em class="property"> = 'in_to_hidden'</em><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.IN_TO_HIDDEN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['in_to_hidden', 'hidden_to_hidden'])</em><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.hidden_to_hidden_linear">
<code class="descname">hidden_to_hidden_linear</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.hidden_to_hidden_linear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.hidden_to_hidden_variables">
<code class="descname">hidden_to_hidden_variables</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.hidden_to_hidden_variables" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.in_to_hidden_linear">
<code class="descname">in_to_hidden_linear</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.in_to_hidden_linear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.in_to_hidden_variables">
<code class="descname">in_to_hidden_variables</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.in_to_hidden_variables" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.basic_rnn.VanillaRNN.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.basic_rnn.VanillaRNN.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-basic-rnn-test-module">
<h2>sonnet.python.modules.basic_rnn_test module<a class="headerlink" href="#sonnet-python-modules-basic-rnn-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="sonnet-python-modules-basic-test-module">
<h2>sonnet.python.modules.basic_test module<a class="headerlink" href="#sonnet-python-modules-basic-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.batch_norm">
<span id="sonnet-python-modules-batch-norm-module"></span><h2>sonnet.python.modules.batch_norm module<a class="headerlink" href="#module-sonnet.python.modules.batch_norm" title="Permalink to this headline">¶</a></h2>
<p>Batch normalization module for Sonnet.</p>
<p>This contains the module BatchNorm, which performs batch normalization
on its inputs. It has an optional post-normalization scale and offset,
and it maintains moving averages of the statistics for use at test time.</p>
<dl class="class">
<dt id="sonnet.python.modules.batch_norm.BatchNorm">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.batch_norm.</code><code class="descname">BatchNorm</code><span class="sig-paren">(</span><em>axis=None</em>, <em>offset=True</em>, <em>scale=False</em>, <em>decay_rate=0.999</em>, <em>eps=0.001</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>update_ops_collection='update_ops'</em>, <em>fused=False</em>, <em>name='batch_norm'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm.html#BatchNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Batch normalization module, including optional affine transformation.</p>
<p>This module maintains exponential moving averages of the mean and
variance, which can be optionally used to normalize at test time.</p>
<p>At training time, batch statistics (mean, variance) are not shared
between separate connections. The moving averages are shared between
separate connections. At both training and test time, the optional
affine transformation (<code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">gamma</span> <span class="pre">+</span> <span class="pre">beta</span></code>) is shared between separate
connections.</p>
<p>This is also the case for distributed replica training, where the batch
statistics are not aggregated across replicas, but the moving averages
are shared globally.</p>
<p>When connecting the module to the graph, <code class="docutils literal notranslate"><span class="pre">is_training=True</span></code> means that</p>
<ul class="simple">
<li>Update ops are created to update the moving averages with the current
batch’s statistics.</li>
<li>Features are normalized using the <em>current batch’s statistics</em>. The
<code class="docutils literal notranslate"><span class="pre">test_local_stats</span></code> setting is ignored. The moving averages are
<strong>not</strong> used.</li>
</ul>
<p>whereas <code class="docutils literal notranslate"><span class="pre">is_training=False</span></code> means that</p>
<ul class="simple">
<li>Update ops are not created.</li>
<li>Features are normalized using either:<ul>
<li>The test batch statistics if <code class="docutils literal notranslate"><span class="pre">test_local_stats=True</span></code> (default).</li>
<li>The moving averages if <code class="docutils literal notranslate"><span class="pre">test_local_stats=False</span></code>.</li>
</ul>
</li>
</ul>
<p>Local batch statistics are used by default at test time, but the moving
averages can be used by specifying a flag when connecting. One often
wants to use local batch statistics at test time to track the progress
while the model is trained as it would ensure that moving average
updates do not affect the training curves. Once the training is
finished, it’s often advantageous to use moving average statistics,
since it would make evaluation agnostic to the batch size, and might
even lead to small improvements over the local batch statistics.</p>
<p>You can either update the moving averages automatically by setting
<code class="docutils literal notranslate"><span class="pre">update_ops_collection=None</span></code> or by running the ops in the given
collection, by default tf.GraphKeys.UPDATE_OPS.</p>
<p>For example, to run the updates automatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span> <span class="o">=</span> <span class="n">BatchNorm</span><span class="p">(</span><span class="n">update_ops_collection</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">train_net</span> <span class="o">=</span> <span class="n">bn</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>this does, however, have the effect of blocking the forwards pass of the
network until the update ops have been run and may have a small
performance penalty.</p>
<p>For example, to run the updates manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span> <span class="o">=</span> <span class="n">BatchNorm</span><span class="p">()</span>
<span class="n">train_net</span> <span class="o">=</span> <span class="n">bn</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="o">...</span>

<span class="n">update_ops</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="o">*</span><span class="n">tf</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">GraphKeys</span><span class="o">.</span><span class="n">UPDATE_OPS</span><span class="p">))</span>
<span class="n">train_op</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">train_op</span><span class="p">,</span> <span class="n">update_ops</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, whenever <code class="docutils literal notranslate"><span class="pre">train_op</span></code> is run so also are the moving average update
ops.</p>
<p>Some batch normalization caveats:</p>
<ul class="simple">
<li>Batch normalization will remove the effect of adding a bias, so e.g.
<code class="docutils literal notranslate"><span class="pre">use_bias=False</span></code> should be used for an immediately preceding
snt.Linear module.</li>
<li>If your data batches aren’t i.i.d. then batch normalization can allow
your network to ‘cheat’ by using the batch statistics to peek at the
rest of the batch. This can exhibit itself as a higher test score
with <code class="docutils literal notranslate"><span class="pre">test_local_stats=True</span></code> than <code class="docutils literal notranslate"><span class="pre">test_local_stats=False</span></code>.</li>
</ul>
<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.BETA">
<code class="descname">BETA</code><em class="property"> = 'beta'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.BETA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.GAMMA">
<code class="descname">GAMMA</code><em class="property"> = 'gamma'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.GAMMA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.MOVING_MEAN">
<code class="descname">MOVING_MEAN</code><em class="property"> = 'moving_mean'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.MOVING_MEAN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.MOVING_VARIANCE">
<code class="descname">MOVING_VARIANCE</code><em class="property"> = 'moving_variance'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.MOVING_VARIANCE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['moving_mean', 'beta', 'moving_variance', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.POSSIBLE_PARTITIONER_KEYS">
<code class="descname">POSSIBLE_PARTITIONER_KEYS</code><em class="property"> = set(['beta', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.POSSIBLE_PARTITIONER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.POSSIBLE_REGULARIZER_KEYS">
<code class="descname">POSSIBLE_REGULARIZER_KEYS</code><em class="property"> = set(['beta', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.POSSIBLE_REGULARIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.beta">
<code class="descname">beta</code><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.beta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.gamma">
<code class="descname">gamma</code><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.initializers">
<code class="descname">initializers</code><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.initializers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.moving_mean">
<code class="descname">moving_mean</code><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.moving_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.moving_variance">
<code class="descname">moving_variance</code><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.moving_variance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.partitioners">
<code class="descname">partitioners</code><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.partitioners" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm.BatchNorm.regularizers">
<code class="descname">regularizers</code><a class="headerlink" href="#sonnet.python.modules.batch_norm.BatchNorm.regularizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm.create_beta_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm.</code><code class="descname">create_beta_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm.html#create_beta_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm.create_beta_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">beta</span></code> in batch norm.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm.create_gamma_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm.</code><code class="descname">create_gamma_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm.html#create_gamma_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm.create_gamma_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">gamma</span></code> in batch norm.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm.create_mean_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm.</code><code class="descname">create_mean_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm.html#create_mean_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm.create_mean_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">moving_mean</span></code> in batch norm.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm.create_variance_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm.</code><code class="descname">create_variance_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm.html#create_variance_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm.create_variance_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">moving_variance</span></code> in batch norm.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-batch-norm-test-module">
<h2>sonnet.python.modules.batch_norm_test module<a class="headerlink" href="#sonnet-python-modules-batch-norm-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.batch_norm_v2">
<span id="sonnet-python-modules-batch-norm-v2-module"></span><h2>sonnet.python.modules.batch_norm_v2 module<a class="headerlink" href="#module-sonnet.python.modules.batch_norm_v2" title="Permalink to this headline">¶</a></h2>
<p>Batch normalization module for Sonnet.</p>
<p>This contains the module BatchNormV2, which performs batch normalization
on its inputs. It has an optional post-normalization scale and offset,
and it maintains moving averages of the statistics for use at test time.</p>
<dl class="class">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.batch_norm_v2.</code><code class="descname">BatchNormV2</code><span class="sig-paren">(</span><em>data_format=None</em>, <em>offset=True</em>, <em>scale=False</em>, <em>decay_rate=0.999</em>, <em>eps=0.001</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>update_ops_collection=None</em>, <em>fused=True</em>, <em>name='batch_norm'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm_v2.html#BatchNormV2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Batch normalization module, including optional affine transformation.</p>
<p>This module maintains exponential moving averages of the mean and
variance, which can be optionally used to normalize at test time.</p>
<p>At training time, batch statistics (mean, variance) are not shared
between separate connections. The moving averages are shared between
separate connections. At both training and test time, the optional
affine transformation (<code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">gamma</span> <span class="pre">+</span> <span class="pre">beta</span></code>) is shared between separate
connections.</p>
<p>This is also the case for distributed replica training, where the batch
statistics are not aggregated across replicas, but the moving averages
are shared globally.</p>
<p>When connecting the module to the graph, <code class="docutils literal notranslate"><span class="pre">is_training=True</span></code> means that</p>
<ul class="simple">
<li>Update ops are created to update the moving averages with the current
batch’s statistics.</li>
<li>Features are normalized using the <em>current batch’s statistics</em>. The
<code class="docutils literal notranslate"><span class="pre">test_local_stats</span></code> setting is ignored. The moving averages are
<strong>not</strong> used.</li>
</ul>
<p>whereas <code class="docutils literal notranslate"><span class="pre">is_training=False</span></code> means that</p>
<ul class="simple">
<li>Update ops are not created.</li>
<li>Features are normalized using either:<ul>
<li>The moving averages if <code class="docutils literal notranslate"><span class="pre">test_local_stats=False</span></code> (default).</li>
<li>The test batch statistics if <code class="docutils literal notranslate"><span class="pre">test_local_stats=True</span></code>.</li>
</ul>
</li>
</ul>
<p>The moving averages are used by default at test time, but local batch
statistics can be used by specifying a flag when connecting. One often
wants to use local batch statistics at test time to track the progress
while the model is trained as it would ensure that moving average
updates do not affect the training curves. Once the training is
finished, it’s often advantageous to use moving average statistics,
since it would make evaluation agnostic to the batch size, and might
even lead to small improvements over the local batch statistics.</p>
<p>The moving averages will be updated automatically by default, but not if
<code class="docutils literal notranslate"><span class="pre">update_ops_collection</span></code> is provided: in that case they will only be
updated when the ops in that collection are run.</p>
<p>For example, to run the updates automatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span> <span class="o">=</span> <span class="n">BatchNormV2</span><span class="p">()</span>
<span class="n">train_net</span> <span class="o">=</span> <span class="n">bn</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>this does, however, have the effect of blocking the forwards pass of the
network until the update ops have been run and may have a small
performance penalty.</p>
<p>For example, to run the updates manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bn</span> <span class="o">=</span> <span class="n">BatchNormV2</span><span class="p">(</span><span class="n">update_ops_collection</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">GraphKeys</span><span class="o">.</span><span class="n">UPDATE_OPS</span><span class="p">)</span>
<span class="n">train_net</span> <span class="o">=</span> <span class="n">bn</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">is_training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="o">...</span>

<span class="n">update_ops</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="o">*</span><span class="n">tf</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">GraphKeys</span><span class="o">.</span><span class="n">UPDATE_OPS</span><span class="p">))</span>
<span class="n">train_op</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">train_op</span><span class="p">,</span> <span class="n">update_ops</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, whenever <code class="docutils literal notranslate"><span class="pre">train_op</span></code> is run so also are the moving average update
ops.</p>
<p>Some batch normalization caveats:</p>
<ul class="simple">
<li>Batch normalization will remove the effect of adding a bias, so e.g.
<code class="docutils literal notranslate"><span class="pre">use_bias=False</span></code> should be used for an immediately preceding
snt.Linear module.</li>
<li>If your data batches aren’t i.i.d. then batch normalization can allow
your network to ‘cheat’ by using the batch statistics to peek at the
rest of the batch. This can exhibit itself as a higher test score
with <code class="docutils literal notranslate"><span class="pre">test_local_stats=True</span></code> than <code class="docutils literal notranslate"><span class="pre">test_local_stats=False</span></code>.</li>
</ul>
<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.BETA">
<code class="descname">BETA</code><em class="property"> = 'beta'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.BETA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.GAMMA">
<code class="descname">GAMMA</code><em class="property"> = 'gamma'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.GAMMA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.MOVING_MEAN">
<code class="descname">MOVING_MEAN</code><em class="property"> = 'moving_mean'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.MOVING_MEAN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.MOVING_VARIANCE">
<code class="descname">MOVING_VARIANCE</code><em class="property"> = 'moving_variance'</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.MOVING_VARIANCE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['moving_mean', 'beta', 'moving_variance', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.POSSIBLE_PARTITIONER_KEYS">
<code class="descname">POSSIBLE_PARTITIONER_KEYS</code><em class="property"> = set(['beta', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.POSSIBLE_PARTITIONER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.POSSIBLE_REGULARIZER_KEYS">
<code class="descname">POSSIBLE_REGULARIZER_KEYS</code><em class="property"> = set(['beta', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.POSSIBLE_REGULARIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.SUPPORTED_DATA_FORMATS">
<code class="descname">SUPPORTED_DATA_FORMATS</code><em class="property"> = set(['NHWC', 'NDHWC', 'NWC', 'NCHW', 'NC', 'NCDHW', 'NCW'])</em><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.SUPPORTED_DATA_FORMATS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.beta">
<code class="descname">beta</code><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.beta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.gamma">
<code class="descname">gamma</code><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.initializers">
<code class="descname">initializers</code><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.initializers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.moving_mean">
<code class="descname">moving_mean</code><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.moving_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.moving_variance">
<code class="descname">moving_variance</code><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.moving_variance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.partitioners">
<code class="descname">partitioners</code><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.partitioners" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.batch_norm_v2.BatchNormV2.regularizers">
<code class="descname">regularizers</code><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.BatchNormV2.regularizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm_v2.create_beta_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm_v2.</code><code class="descname">create_beta_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm_v2.html#create_beta_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.create_beta_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">beta</span></code> in batch norm.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm_v2.create_gamma_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm_v2.</code><code class="descname">create_gamma_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm_v2.html#create_gamma_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.create_gamma_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">gamma</span></code> in batch norm.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm_v2.create_mean_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm_v2.</code><code class="descname">create_mean_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm_v2.html#create_mean_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.create_mean_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">moving_mean</span></code> in batch norm.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.batch_norm_v2.create_variance_initializer">
<code class="descclassname">sonnet.python.modules.batch_norm_v2.</code><code class="descname">create_variance_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/batch_norm_v2.html#create_variance_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.batch_norm_v2.create_variance_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">moving_variance</span></code> in batch norm.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-batch-norm-v2-test-module">
<h2>sonnet.python.modules.batch_norm_v2_test module<a class="headerlink" href="#sonnet-python-modules-batch-norm-v2-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.block_matrix">
<span id="sonnet-python-modules-block-matrix-module"></span><h2>sonnet.python.modules.block_matrix module<a class="headerlink" href="#module-sonnet.python.modules.block_matrix" title="Permalink to this headline">¶</a></h2>
<p>Modules for dealing with block matrices.</p>
<dl class="class">
<dt id="sonnet.python.modules.block_matrix.BlockDiagonalMatrix">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.block_matrix.</code><code class="descname">BlockDiagonalMatrix</code><span class="sig-paren">(</span><em>block_shape</em>, <em>block_rows</em>, <em>name='block_diagonal_matrix'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/block_matrix.html#BlockDiagonalMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.block_matrix.BlockDiagonalMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.block_matrix.BlockTriangularMatrix" title="sonnet.python.modules.block_matrix.BlockTriangularMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.block_matrix.BlockTriangularMatrix</span></code></a></p>
<p>Module for constructing a block diagonal matrix from a vector.</p>
<p>This module takes a vector and builds a block diagonal matrix from it.
The blocks have equal shape, <code class="docutils literal notranslate"><span class="pre">block_shape</span></code>, and the number of rows
(and, hence, the number of columns) needs to be specified in advance.</p>
<p>Example: suppose that we choose <code class="docutils literal notranslate"><span class="pre">block_shape</span> <span class="pre">=</span> <span class="pre">(2,</span> <span class="pre">2)</span></code> and
<code class="docutils literal notranslate"><span class="pre">block_rows</span> <span class="pre">=</span> <span class="pre">3</span></code>. Then, the input vector <code class="docutils literal notranslate"><span class="pre">[1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">...</span> <span class="pre">12]</span></code> is mapped
to the matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">9</span> <span class="mi">10</span>
      <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="mi">11</span> <span class="mi">12</span><span class="p">]</span><span class="o">.</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.block_matrix.BlockTriangularMatrix">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.block_matrix.</code><code class="descname">BlockTriangularMatrix</code><span class="sig-paren">(</span><em>block_shape</em>, <em>block_rows</em>, <em>include_diagonal=True</em>, <em>include_off_diagonal=True</em>, <em>upper=False</em>, <em>name='block_triangular_matrix'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/block_matrix.html#BlockTriangularMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.block_matrix.BlockTriangularMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Module for constructing a block triangular matrix from a vector.</p>
<p>This module takes a vector and builds a block (upper or lower)
triangular matrix from it. The blocks have equal shape, <code class="docutils literal notranslate"><span class="pre">block_shape</span></code>,
and the number of rows (and, hence, the number of columns) needs to be
specified in advance. The diagonal may be excluded by setting the
argument <code class="docutils literal notranslate"><span class="pre">include_diagonal</span></code> to False.</p>
<p>Example: suppose that we choose <code class="docutils literal notranslate"><span class="pre">block_shape</span> <span class="pre">=</span> <span class="pre">(2,</span> <span class="pre">2)</span></code> and
<code class="docutils literal notranslate"><span class="pre">block_rows</span> <span class="pre">=</span> <span class="pre">3</span></code>. Then, the input vector <code class="docutils literal notranslate"><span class="pre">[1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">...</span> <span class="pre">24]</span></code> is mapped
to the matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">0</span>  <span class="mi">0</span>
      <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span>  <span class="mi">0</span>  <span class="mi">0</span>
     <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span>
     <span class="mi">19</span> <span class="mi">20</span> <span class="mi">21</span> <span class="mi">22</span> <span class="mi">23</span> <span class="mi">24</span><span class="p">]</span><span class="o">.</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sonnet.python.modules.block_matrix.BlockTriangularMatrix.block_shape">
<code class="descname">block_shape</code><a class="headerlink" href="#sonnet.python.modules.block_matrix.BlockTriangularMatrix.block_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of each block.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.block_matrix.BlockTriangularMatrix.block_size">
<code class="descname">block_size</code><a class="headerlink" href="#sonnet.python.modules.block_matrix.BlockTriangularMatrix.block_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of entries of each block.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.block_matrix.BlockTriangularMatrix.input_size">
<code class="descname">input_size</code><a class="headerlink" href="#sonnet.python.modules.block_matrix.BlockTriangularMatrix.input_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The expected length of the input vector.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.block_matrix.BlockTriangularMatrix.num_blocks">
<code class="descname">num_blocks</code><a class="headerlink" href="#sonnet.python.modules.block_matrix.BlockTriangularMatrix.num_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of blocks in the output matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.block_matrix.BlockTriangularMatrix.output_shape">
<code class="descname">output_shape</code><a class="headerlink" href="#sonnet.python.modules.block_matrix.BlockTriangularMatrix.output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the output matrix.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-block-matrix-test-module">
<h2>sonnet.python.modules.block_matrix_test module<a class="headerlink" href="#sonnet-python-modules-block-matrix-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.clip_gradient">
<span id="sonnet-python-modules-clip-gradient-module"></span><h2>sonnet.python.modules.clip_gradient module<a class="headerlink" href="#module-sonnet.python.modules.clip_gradient" title="Permalink to this headline">¶</a></h2>
<p>Tensorflow op that clips gradient for backwards pass.</p>
<dl class="function">
<dt id="sonnet.python.modules.clip_gradient.clip_gradient">
<code class="descclassname">sonnet.python.modules.clip_gradient.</code><code class="descname">clip_gradient</code><span class="sig-paren">(</span><em>net</em>, <em>clip_value_min</em>, <em>clip_value_max</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/clip_gradient.html#clip_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.clip_gradient.clip_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Clips respective gradients of a given tensor.</p>
<p>Acts as identity for the forward pass, but clips gradient tensor
element-wise by value during the backward pass. Any gradient values less
than <code class="docutils literal notranslate"><span class="pre">clip_value_min</span></code> or greater than <code class="docutils literal notranslate"><span class="pre">clip_values_max</span></code> are set to
the respective limit values.</p>
<p>Args: net: A <code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code>. clip_value_min: A 0-D Tensor or scalar.
The minimum value to clip by. clip_value_max: A 0-D Tensor or scalar.
The maximum value to clip by. name: A name for the operation (optional,
default ‘clip_gradient’).</p>
<p>Returns: A <code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code> with the same type as the input tensor.</p>
<p>Raises: ValueError: If <code class="docutils literal notranslate"><span class="pre">net</span></code> dtype is non-float.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-clip-gradient-test-module">
<h2>sonnet.python.modules.clip_gradient_test module<a class="headerlink" href="#sonnet-python-modules-clip-gradient-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.conv">
<span id="sonnet-python-modules-conv-module"></span><h2>sonnet.python.modules.conv module<a class="headerlink" href="#module-sonnet.python.modules.conv" title="Permalink to this headline">¶</a></h2>
<p>Implementation of convolutional Sonnet modules.</p>
<p>Classes defining convolutional operations, inheriting from
<code class="docutils literal notranslate"><span class="pre">snt.Module</span></code>, with easy weight sharing.</p>
<dl class="class">
<dt id="sonnet.python.modules.conv.CausalConv1D">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">CausalConv1D</code><span class="sig-paren">(</span><em>output_channels</em>, <em>kernel_shape</em>, <em>stride=1</em>, <em>rate=1</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>mask=None</em>, <em>padding='VALID'</em>, <em>data_format='NWC'</em>, <em>custom_getter=None</em>, <em>name='causal_conv_1d'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#CausalConv1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.CausalConv1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvND</span></code></p>
<p>1D convolution module, including optional bias.</p>
<p>This acts as a light wrapper around _ConvND ensuring that the outputs
at index <code class="docutils literal notranslate"><span class="pre">i</span></code> only depend on indices smaller than <code class="docutils literal notranslate"><span class="pre">i</span></code> (also known as
a causal convolution). For further details on the theoretical
background, refer to:</p>
<p><a class="reference external" href="https://arxiv.org/abs/1610.10099">https://arxiv.org/abs/1610.10099</a></p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.Conv1D">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">Conv1D</code><span class="sig-paren">(</span><em>output_channels</em>, <em>kernel_shape</em>, <em>stride=1</em>, <em>rate=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>mask=None</em>, <em>data_format='NWC'</em>, <em>custom_getter=None</em>, <em>name='conv_1d'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvND</span></code>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>1D convolution module, including optional bias.</p>
<p>This acts as a light wrapper around the class <code class="docutils literal notranslate"><span class="pre">_ConvND</span></code>.</p>
<dl class="method">
<dt id="sonnet.python.modules.conv.Conv1D.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv1D.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv1D.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matching <code class="docutils literal notranslate"><span class="pre">Conv1DTranspose</span></code> module.</p>
<p>Args: name: Optional string assigning name of transpose module. The
default name is constructed by appending “_transpose” to <code class="docutils literal notranslate"><span class="pre">self.name</span></code>.</p>
<p>Returns: <code class="docutils literal notranslate"><span class="pre">Conv1DTranspose</span></code> module.</p>
<p>Raises: base.NotSupportedError: If <code class="docutils literal notranslate"><span class="pre">rate</span></code> in any dimension &gt; 1.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.Conv1DTranspose">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">Conv1DTranspose</code><span class="sig-paren">(</span><em>output_channels</em>, <em>output_shape=None</em>, <em>kernel_shape=None</em>, <em>stride=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>data_format='NWC'</em>, <em>custom_getter=None</em>, <em>name='conv_1d_transpose'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv1DTranspose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv1DTranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvNDTranspose</span></code>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>1D transposed / reverse / up 1D convolution module, including bias.</p>
<p>This performs a 1D transpose convolution by lightly wrapping the
TensorFlow op <code class="docutils literal notranslate"><span class="pre">tf.nn.conv2d_transpose</span></code>, setting the size of the height
dimension of the image to 1.</p>
<dl class="method">
<dt id="sonnet.python.modules.conv.Conv1DTranspose.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv1DTranspose.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv1DTranspose.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matching <code class="docutils literal notranslate"><span class="pre">Conv1D</span></code> module.</p>
<p>Args: name: Optional string assigning name of transpose module. The
default name is constructed by appending “_transpose” to <code class="docutils literal notranslate"><span class="pre">self.name</span></code>.</p>
<p>Returns: <code class="docutils literal notranslate"><span class="pre">Conv1D</span></code> module.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.Conv2D">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">Conv2D</code><span class="sig-paren">(</span><em>output_channels</em>, <em>kernel_shape</em>, <em>stride=1</em>, <em>rate=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>mask=None</em>, <em>data_format='NHWC'</em>, <em>custom_getter=None</em>, <em>name='conv_2d'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvND</span></code>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>Spatial convolution and dilated convolution module, including bias.</p>
<p>This acts as a light wrapper around the class <code class="docutils literal notranslate"><span class="pre">_ConvND</span></code>.</p>
<dl class="method">
<dt id="sonnet.python.modules.conv.Conv2D.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv2D.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv2D.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matching <code class="docutils literal notranslate"><span class="pre">Conv2DTranspose</span></code> module.</p>
<p>Args: name: Optional string assigning name of transpose module. The
default name is constructed by appending “_transpose” to <code class="docutils literal notranslate"><span class="pre">self.name</span></code>.</p>
<p>Returns: <code class="docutils literal notranslate"><span class="pre">Conv2DTranspose</span></code> module.</p>
<p>Raises: base.NotSupportedError: If <code class="docutils literal notranslate"><span class="pre">rate</span></code> in any dimension &gt; 1.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.Conv2DTranspose">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">Conv2DTranspose</code><span class="sig-paren">(</span><em>output_channels</em>, <em>output_shape=None</em>, <em>kernel_shape=None</em>, <em>stride=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>data_format='NHWC'</em>, <em>custom_getter=None</em>, <em>name='conv_2d_transpose'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv2DTranspose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv2DTranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvNDTranspose</span></code>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>Spatial transposed / reverse / up 2D convolution module, including bias.</p>
<p>This acts as a light wrapper around the TensorFlow op
<code class="docutils literal notranslate"><span class="pre">tf.nn.conv2d_transpose</span></code> abstracting away variable creation and
sharing.</p>
<dl class="method">
<dt id="sonnet.python.modules.conv.Conv2DTranspose.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv2DTranspose.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv2DTranspose.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matching <code class="docutils literal notranslate"><span class="pre">Conv2D</span></code> module.</p>
<p>Args: name: Optional string assigning name of transpose module. The
default name is constructed by appending “_transpose” to <code class="docutils literal notranslate"><span class="pre">self.name</span></code>.</p>
<p>Returns: <code class="docutils literal notranslate"><span class="pre">Conv2D</span></code> module.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.Conv3D">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">Conv3D</code><span class="sig-paren">(</span><em>output_channels</em>, <em>kernel_shape</em>, <em>stride=1</em>, <em>rate=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>mask=None</em>, <em>data_format='NDHWC'</em>, <em>custom_getter=None</em>, <em>name='conv_3d'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvND</span></code>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>Volumetric convolution module, including optional bias.</p>
<p>This acts as a light wrapper around the class <code class="docutils literal notranslate"><span class="pre">_ConvND</span></code>.</p>
<dl class="method">
<dt id="sonnet.python.modules.conv.Conv3D.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv3D.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv3D.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns matching <code class="docutils literal notranslate"><span class="pre">Conv3DTranspose</span></code> module.</p>
<p>Args: name: Optional string assigning name of transpose module. The
default name is constructed by appending “_transpose” to <code class="docutils literal notranslate"><span class="pre">self.name</span></code>.</p>
<p>Returns: <code class="docutils literal notranslate"><span class="pre">Conv3DTranspose</span></code> module.</p>
<p>Raises: base.NotSupportedError: If <code class="docutils literal notranslate"><span class="pre">rate</span></code> in any dimension &gt; 1.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.Conv3DTranspose">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">Conv3DTranspose</code><span class="sig-paren">(</span><em>output_channels</em>, <em>output_shape=None</em>, <em>kernel_shape=None</em>, <em>stride=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>data_format='NDHWC'</em>, <em>custom_getter=None</em>, <em>name='conv_3d_transpose'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv3DTranspose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv3DTranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvNDTranspose</span></code>, <a class="reference internal" href="#sonnet.python.modules.base.Transposable" title="sonnet.python.modules.base.Transposable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.Transposable</span></code></a></p>
<p>Volumetric transposed / reverse / up 3D convolution module, including
bias.</p>
<p>This acts as a light wrapper around the TensorFlow op
<code class="docutils literal notranslate"><span class="pre">tf.nn.conv3d_transpose</span></code> abstracting away variable creation and
sharing.</p>
<dl class="method">
<dt id="sonnet.python.modules.conv.Conv3DTranspose.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#Conv3DTranspose.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.Conv3DTranspose.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns transposed Conv3DTranspose module, i.e. a Conv3D module.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.DepthwiseConv2D">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">DepthwiseConv2D</code><span class="sig-paren">(</span><em>channel_multiplier</em>, <em>kernel_shape</em>, <em>stride=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>data_format='NHWC'</em>, <em>custom_getter=None</em>, <em>name='conv_2d_depthwise'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#DepthwiseConv2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.DepthwiseConv2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvND</span></code></p>
<p>Spatial depthwise 2D convolution module, including bias.</p>
<p>This acts as a light wrapper around the TensorFlow ops
<code class="docutils literal notranslate"><span class="pre">tf.nn.depthwise_conv2d</span></code>, abstracting away variable creation and
sharing.</p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.InPlaneConv2D">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">InPlaneConv2D</code><span class="sig-paren">(</span><em>kernel_shape</em>, <em>stride=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>data_format='NHWC'</em>, <em>custom_getter=None</em>, <em>name='in_plane_conv2d'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#InPlaneConv2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.InPlaneConv2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.conv._ConvND</span></code></p>
<p>Applies an in-plane convolution to each channel with tied filter
weights.</p>
<p>This acts as a light wrapper around the TensorFlow op
<code class="docutils literal notranslate"><span class="pre">tf.nn.depthwise_conv2d</span></code>; it differs from the DepthWiseConv2D module
in that it has tied weights (i.e. the same filter) for all the in-out
channel pairs.</p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.conv.SeparableConv2D">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">SeparableConv2D</code><span class="sig-paren">(</span><em>output_channels</em>, <em>channel_multiplier</em>, <em>kernel_shape</em>, <em>stride=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>data_format='NHWC'</em>, <em>custom_getter=None</em>, <em>name='Separable_conv2d'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#SeparableConv2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Performs an in-plane convolution to each channel independently.</p>
<p>This acts as a light wrapper around the TensorFlow op
<code class="docutils literal notranslate"><span class="pre">tf.nn.separable_conv2d</span></code>, abstracting away variable creation and
sharing.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.b">
<code class="descname">b</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing the bias.</p>
<p>Returns: Variable object containing the bias, from the most recent
<strong>call</strong>.</p>
<p>Raises: base.NotConnectedError: If the module has not been connected to
the graph yet, meaning the variables do not exist. AttributeError: If
the module does not use bias.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.channel_multiplier">
<code class="descname">channel_multiplier</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.channel_multiplier" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the channel multiplier.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.data_format">
<code class="descname">data_format</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.data_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data format.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.conv.SeparableConv2D.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>use_bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#SeparableConv2D.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>This provides the user with a way of knowing the initializer keys that
are available without having to instantiate a sonnet module. Subclasses
may override this class method if they need additional arguments to
determine what initializer keys may be provided.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.has_bias">
<code class="descname">has_bias</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.has_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if bias Variable is present in the module.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.initializers">
<code class="descname">initializers</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.initializers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the initializers dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.input_channels">
<code class="descname">input_channels</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.input_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of input channels.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.input_shape">
<code class="descname">input_shape</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.input_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the input shape.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.kernel_shape">
<code class="descname">kernel_shape</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.kernel_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the kernel shape.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.output_channels">
<code class="descname">output_channels</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.output_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of output channels.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.padding">
<code class="descname">padding</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the padding algorithm.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.partitioners">
<code class="descname">partitioners</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.partitioners" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the partitioners dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.regularizers">
<code class="descname">regularizers</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.regularizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the regularizers dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.stride">
<code class="descname">stride</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the stride.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.w_dw">
<code class="descname">w_dw</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.w_dw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing the depthwise weight matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.conv.SeparableConv2D.w_pw">
<code class="descname">w_pw</code><a class="headerlink" href="#sonnet.python.modules.conv.SeparableConv2D.w_pw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing the pointwise weight matrix.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.conv.create_bias_initializer">
<code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">create_bias_initializer</code><span class="sig-paren">(</span><em>unused_bias_shape</em>, <em>dtype=tf.float32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#create_bias_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.create_bias_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the biases of a convolutional module.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.conv.create_weight_initializer">
<code class="descclassname">sonnet.python.modules.conv.</code><code class="descname">create_weight_initializer</code><span class="sig-paren">(</span><em>fan_in_shape</em>, <em>dtype=tf.float32</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/conv.html#create_weight_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.conv.create_weight_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the weights of a convolutional module.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-conv-gpu-test-module">
<h2>sonnet.python.modules.conv_gpu_test module<a class="headerlink" href="#sonnet-python-modules-conv-gpu-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="sonnet-python-modules-conv-test-module">
<h2>sonnet.python.modules.conv_test module<a class="headerlink" href="#sonnet-python-modules-conv-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.embed">
<span id="sonnet-python-modules-embed-module"></span><h2>sonnet.python.modules.embed module<a class="headerlink" href="#module-sonnet.python.modules.embed" title="Permalink to this headline">¶</a></h2>
<p>Modules for embedding integer ids.</p>
<dl class="class">
<dt id="sonnet.python.modules.embed.Embed">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.embed.</code><code class="descname">Embed</code><span class="sig-paren">(</span><em>vocab_size=None</em>, <em>embed_dim=None</em>, <em>existing_vocab=None</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>trainable=True</em>, <em>custom_getter=None</em>, <em>name='embed'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/embed.html#Embed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.embed.Embed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Module for embedding tokens in a low-dimensional space.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.embed.Embed.EMBEDDINGS">
<code class="descname">EMBEDDINGS</code><em class="property"> = 'embeddings'</em><a class="headerlink" href="#sonnet.python.modules.embed.Embed.EMBEDDINGS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.embed.Embed.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['embeddings'])</em><a class="headerlink" href="#sonnet.python.modules.embed.Embed.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.embed.Embed.embed_dim">
<code class="descname">embed_dim</code><a class="headerlink" href="#sonnet.python.modules.embed.Embed.embed_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of embedding vectors.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.embed.Embed.embeddings">
<code class="descname">embeddings</code><a class="headerlink" href="#sonnet.python.modules.embed.Embed.embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Variable containing embeddings.</p>
<p>Returns: A 2D Variable containing one embedding vector per row,
constructed in the most recent <strong>call</strong>.</p>
<p>Raises: base.NotConnectedError: If the module has not been connected to
the graph yet, meaning the variables do not exist.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.embed.Embed.vocab_size">
<code class="descname">vocab_size</code><a class="headerlink" href="#sonnet.python.modules.embed.Embed.vocab_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of input vocabulary.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-embed-test-module">
<h2>sonnet.python.modules.embed_test module<a class="headerlink" href="#sonnet-python-modules-embed-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.experimental">
<span id="sonnet-python-modules-experimental-module"></span><h2>sonnet.python.modules.experimental module<a class="headerlink" href="#module-sonnet.python.modules.experimental" title="Permalink to this headline">¶</a></h2>
<p>Module for experimental sonnet functions and classes.</p>
<p>This file contains functions and classes that are being tested until
they’re either removed or promoted into the wider sonnet library.</p>
<dl class="function">
<dt id="sonnet.python.modules.experimental.reuse_vars">
<code class="descclassname">sonnet.python.modules.experimental.</code><code class="descname">reuse_vars</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/experimental.html#reuse_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.experimental.reuse_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED FUNCTION</p>
<p>THIS FUNCTION IS DEPRECATED. It will be removed after 2017-08-01.
Instructions for updating: The &#64;snt.experimental.reuse_vars decorator
has been moved to &#64;snt.reuse_variables. Please change to use the new
location.</p>
</dd></dl>

</div>
<div class="section" id="module-sonnet.python.modules.gated_rnn">
<span id="sonnet-python-modules-gated-rnn-module"></span><h2>sonnet.python.modules.gated_rnn module<a class="headerlink" href="#module-sonnet.python.modules.gated_rnn" title="Permalink to this headline">¶</a></h2>
<p>LSTM based modules for TensorFlow snt.</p>
<p>This python module contains LSTM-like cores that fall under the broader
group of RNN cores. In general, initializers for the gate weights and
other model parameters may be passed to the constructor.</p>
<p>Typical usage example of the standard LSTM without peephole connections:</p>
<p>``` import sonnet as snt</p>
<p>hidden_size = 10 batch_size = 2</p>
<p># Simple LSTM op on some input rnn = snt.LSTM(hidden_size) input =
tf.placeholder(tf.float32, shape=[batch_size, hidden_size]) out,
next_state = rnn(input, rnn.initial_state(batch_size)) ```</p>
<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">BatchNormLSTM</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>forget_bias=1.0</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>use_peepholes=False</em>, <em>use_batch_norm_h=True</em>, <em>use_batch_norm_x=False</em>, <em>use_batch_norm_c=False</em>, <em>max_unique_stats=1</em>, <em>hidden_clip_value=None</em>, <em>cell_clip_value=None</em>, <em>custom_getter=None</em>, <em>name='batch_norm_lstm'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#BatchNormLSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>LSTM recurrent network cell with optional peepholes, batch
normalization.</p>
<p>The base implementation is based on: <a class="reference external" href="http://arxiv.org/abs/1409.2329">http://arxiv.org/abs/1409.2329</a>. We
add forget_bias (default: 1) to the biases of the forget gate in order
to reduce the scale of forgetting in the beginning of the training.</p>
<p>Peep-hole connections may optionally be used by specifying a flag in the
constructor. These connections can aid increasing the precision of
output timing, for more details see:</p>
<p><a class="reference external" href="https://research.google.com/pubs/archive/43905.pdf">https://research.google.com/pubs/archive/43905.pdf</a></p>
<p>The batch norm transformation (in training mode) is batchnorm(x) = gamma
* (x - mean(x)) / stddev(x) + beta, where gamma is a learnt scaling
factor and beta is a learnt offset.</p>
<p>Batch normalization may optionally be used at different places in the
LSTM by specifying flag(s) in the constructor. These are applied when
calculating the gate activations and cell-to-hidden transformation. The
set-up is based on</p>
<p><a class="reference external" href="https://arxiv.org/pdf/1603.09025.pdf">https://arxiv.org/pdf/1603.09025.pdf</a></p>
<p>Batch norm can be applied in three different places in the LSTM:</p>
<ol class="loweralpha simple" start="8">
<li>To the W_h h_{t-1} contribution to the gates from the previous
hiddens.</li>
<li>To the W_x x_t contribution to the gates from the current input.</li>
<li>To the cell value c_t when calculating the output h_t from the
cell.</li>
</ol>
<p>(The notation here is consistent with the Recurrent Batch Normalization
paper). Each of these can be controlled individually, because batch norm
is expensive, and not all are necessary. The paper doesn’t mention the
relative effects of these different batch norms; however,
experimentation with a shallow LSTM for the <code class="docutils literal notranslate"><span class="pre">permuted_mnist</span></code> sequence
task suggests that (h) is the most important and the other two can be
left off. For other tasks or deeper (stacked) LSTMs, other batch norm
combinations may be more effective.</p>
<p>When switching to testing (see <code class="docutils literal notranslate"><span class="pre">LSTM.with_batch_norm_control</span></code>), we can
use a mean and stddev learnt from the training data instead of using the
statistics from the test data. (This both increases test accuracy
because the statistics have less variance, and if the test data does not
have the same distribution as the training data then we must use the
training statistics to ensure the effective network does not change when
switching to testing anyhow.)</p>
<p>This does however introduces a slight subtlety. The first few time steps
of the RNN tend to have varying statistics (mean and variance) before
settling down to a steady value. Therefore in general, better
performance is obtained by using separate statistics for the first few
time steps, and then using the final set of statistics for all
subsequent time steps. This is controlled by the parameter
<code class="docutils literal notranslate"><span class="pre">max_unique_stats</span></code>. (We can’t have an unbounded number of distinct
statistics for both technical reasons and also for the case where test
sequences are longer than anything seen in training.)</p>
<p>You may be fine leaving it at its default value of 1. Small values (like
10) may achieve better performance on some tasks when testing with
cached statistics.</p>
<p>Attributes: state_size: Tuple of <code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code>s indicating the
size of state tensors. output_size: <code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code> indicating the
size of the core output. use_peepholes: Boolean indicating whether
peephole connections are used. use_batch_norm_h: Boolean indicating
whether batch norm (h) is enabled. use_batch_norm_x: Boolean
indicating whether batch norm (x) is enabled. use_batch_norm_c:
Boolean indicating whether batch norm (c) is enabled.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.BETA_C">
<code class="descname">BETA_C</code><em class="property"> = 'beta_c'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.BETA_C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.B_GATES">
<code class="descname">B_GATES</code><em class="property"> = 'b_gates'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.B_GATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.CoreWithExtraBuildArgs">
<em class="property">class </em><code class="descname">CoreWithExtraBuildArgs</code><span class="sig-paren">(</span><em>core</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#BatchNormLSTM.CoreWithExtraBuildArgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.CoreWithExtraBuildArgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Wraps an RNNCore so that the build method receives extra args and
kwargs.</p>
<p>This will pass the additional input <code class="docutils literal notranslate"><span class="pre">args</span></code> and <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> to the
_build function of the snt.RNNCore after the input and prev_state
inputs.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.CoreWithExtraBuildArgs.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.CoreWithExtraBuildArgs.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code> indicating the size of the core output.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.CoreWithExtraBuildArgs.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.CoreWithExtraBuildArgs.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple indicating the size of nested state tensors.</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.GAMMA_C">
<code class="descname">GAMMA_C</code><em class="property"> = 'gamma_c'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.GAMMA_C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.GAMMA_H">
<code class="descname">GAMMA_H</code><em class="property"> = 'gamma_h'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.GAMMA_H" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.GAMMA_X">
<code class="descname">GAMMA_X</code><em class="property"> = 'gamma_x'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.GAMMA_X" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.IndexedStatsBatchNorm">
<em class="property">class </em><code class="descname">IndexedStatsBatchNorm</code><span class="sig-paren">(</span><em>max_unique_stats</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#BatchNormLSTM.IndexedStatsBatchNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.IndexedStatsBatchNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>BatchNorm module where batch statistics are selected by an input index.</p>
<p>This is used by LSTM+batchnorm, where we have distinct batch norm
statistics for the first <code class="docutils literal notranslate"><span class="pre">max_unique_stats</span></code> time steps, and then use
the final set of statistics for subsequent time steps.</p>
<p>The module has as input (x, index, is_training, test_local_stats).
During training or when test_local_stats=True, the output is simply
batchnorm(x) (where mean(x) and stddev(x) are used), and during training
the <code class="docutils literal notranslate"><span class="pre">BatchNorm</span></code> module accumulates statistics in mean_i, etc, where i
= min(index, max_unique_stats - 1).</p>
<p>During testing with test_local_stats=False, the output is
batchnorm(x), where mean_i and stddev_i are used instead of mean(x)
and stddev(x).</p>
<p>See the <code class="docutils literal notranslate"><span class="pre">BatchNorm</span></code> module for more on is_training and
test_local_stats.</p>
<p>No offset <code class="docutils literal notranslate"><span class="pre">beta</span></code> or scaling <code class="docutils literal notranslate"><span class="pre">gamma</span></code> are learnt.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['w_f_diag', 'gamma_h', 'b_gates', 'gamma_c', 'w_o_diag', 'beta_c', 'w_i_diag', 'w_gates', 'gamma_x'])</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.POSSIBLE_KEYS">
<code class="descname">POSSIBLE_KEYS</code><em class="property"> = set(['w_f_diag', 'gamma_h', 'b_gates', 'gamma_c', 'w_o_diag', 'beta_c', 'w_i_diag', 'w_gates', 'gamma_x'])</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.POSSIBLE_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.W_F_DIAG">
<code class="descname">W_F_DIAG</code><em class="property"> = 'w_f_diag'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.W_F_DIAG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.W_GATES">
<code class="descname">W_GATES</code><em class="property"> = 'w_gates'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.W_GATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.W_I_DIAG">
<code class="descname">W_I_DIAG</code><em class="property"> = 'w_i_diag'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.W_I_DIAG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.W_O_DIAG">
<code class="descname">W_O_DIAG</code><em class="property"> = 'w_o_diag'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.W_O_DIAG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>use_peepholes=False</em>, <em>use_batch_norm_h=True</em>, <em>use_batch_norm_x=False</em>, <em>use_batch_norm_c=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#BatchNormLSTM.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>The set of all possible initializer keys are: w_gates: weight for gates
b_gates: bias of gates w_f_diag: weight for prev_cell -&gt; forget gate
peephole w_i_diag: weight for prev_cell -&gt; input gate peephole
w_o_diag: weight for prev_cell -&gt; output gate peephole gamma_h:
batch norm scaling for previous_hidden -&gt; gates gamma_x: batch norm
scaling for input -&gt; gates gamma_c: batch norm scaling for cell -&gt;
output beta_c: batch norm bias for cell -&gt; output</p>
<p>Args: cls:The class. use_peepholes: Boolean that indicates whether
peephole connections are used. use_batch_norm_h: Boolean that
indicates whether to apply batch normalization at the previous_hidden
-&gt; gates contribution. If you are experimenting with batch norm then
this may be the most effective to turn on. use_batch_norm_x: Boolean
that indicates whether to apply batch normalization at the input -&gt;
gates contribution. use_batch_norm_c: Boolean that indicates whether
to apply batch normalization at the cell -&gt; output contribution.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.initial_state">
<code class="descname">initial_state</code><span class="sig-paren">(</span><em>batch_size</em>, <em>dtype=tf.float32</em>, <em>trainable=False</em>, <em>trainable_initializers=None</em>, <em>trainable_regularizers=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#BatchNormLSTM.initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the default start state tensor of zeros.</p>
<p>Args: batch_size: An int, float or scalar Tensor representing the batch
size. dtype: The data type to use for the state. trainable: Boolean that
indicates whether to learn the initial state. trainable_initializers:
An optional pair of initializers for the initial hidden state and cell
state. trainable_regularizers: Optional regularizer function or nested
structure of functions with the same structure as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code>
property of the core, to be used as regularizers of the initial state
variable. A regularizer should be a function that takes a single
<code class="docutils literal notranslate"><span class="pre">Tensor</span></code> as an input and returns a scalar <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> output, e.g. the
L1 and L2 regularizers in <code class="docutils literal notranslate"><span class="pre">tf.contrib.layers</span></code>. name: Optional string
used to prefix the initial state variable names, in the case of a
trainable initial state. If not provided, defaults to the name of the
module.</p>
<p>Returns: A tensor tuple
<code class="docutils literal notranslate"><span class="pre">([batch_size,</span> <span class="pre">state_size],</span> <span class="pre">[batch_size,</span> <span class="pre">state_size],</span> <span class="pre">?)</span></code> filled with
zeros, with the third entry present when batch norm is enabled with
<code class="docutils literal notranslate"><span class="pre">max_unique_stats</span> <span class="pre">&gt;</span> <span class="pre">1',</span> <span class="pre">with</span> <span class="pre">value</span></code>0` (representing the time step).</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code> indicating the size of the core output.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of <code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code>s indicating the size of state tensors.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.use_batch_norm_c">
<code class="descname">use_batch_norm_c</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.use_batch_norm_c" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether batch norm for cell -&gt; output is enabled.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.use_batch_norm_h">
<code class="descname">use_batch_norm_h</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.use_batch_norm_h" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether batch norm for hidden -&gt; gates is enabled.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.use_batch_norm_x">
<code class="descname">use_batch_norm_x</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.use_batch_norm_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether batch norm for input -&gt; gates is enabled.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.use_peepholes">
<code class="descname">use_peepholes</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.use_peepholes" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether peephole connections are used.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.gated_rnn.BatchNormLSTM.with_batch_norm_control">
<code class="descname">with_batch_norm_control</code><span class="sig-paren">(</span><em>is_training</em>, <em>test_local_stats=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#BatchNormLSTM.with_batch_norm_control"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.BatchNormLSTM.with_batch_norm_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps this RNNCore with the additional control input to the
<code class="docutils literal notranslate"><span class="pre">BatchNorm</span></code>s.</p>
<p>Example usage:</p>
<p>lstm = snt.BatchNormLSTM(4) is_training = tf.placeholder(tf.bool)
rnn_input = … my_rnn =
rnn.rnn(lstm.with_batch_norm_control(is_training), rnn_input)</p>
<p>Args: is_training: Boolean that indicates whether we are in training
mode or testing mode. When in training mode, the batch norm statistics
are taken from the given batch, and moving statistics are updated. When
in testing mode, the moving statistics are not updated, and in addition
if <code class="docutils literal notranslate"><span class="pre">test_local_stats</span></code> is False then the moving statistics are used for
the batch statistics. See the <code class="docutils literal notranslate"><span class="pre">BatchNorm</span></code> module for more details.
test_local_stats: Boolean scalar indicated whether to use local batch
statistics in test mode.</p>
<p>Returns: snt.RNNCore wrapping this class with the extra input(s) added.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.Conv1DLSTM">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">Conv1DLSTM</code><span class="sig-paren">(</span><em>name='conv_1d_lstm'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#Conv1DLSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.Conv1DLSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.gated_rnn.ConvLSTM" title="sonnet.python.modules.gated_rnn.ConvLSTM"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.gated_rnn.ConvLSTM</span></code></a></p>
<p>1D convolutional LSTM.</p>
<dl class="classmethod">
<dt id="sonnet.python.modules.gated_rnn.Conv1DLSTM.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>use_bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#Conv1DLSTM.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.Conv1DLSTM.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>This provides the user with a way of knowing the initializer keys that
are available without having to instantiate a sonnet module. Subclasses
may override this class method if they need additional arguments to
determine what initializer keys may be provided.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.Conv2DLSTM">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">Conv2DLSTM</code><span class="sig-paren">(</span><em>name='conv_2d_lstm'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#Conv2DLSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.Conv2DLSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.gated_rnn.ConvLSTM" title="sonnet.python.modules.gated_rnn.ConvLSTM"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.gated_rnn.ConvLSTM</span></code></a></p>
<p>2D convolutional LSTM.</p>
<dl class="classmethod">
<dt id="sonnet.python.modules.gated_rnn.Conv2DLSTM.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>use_bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#Conv2DLSTM.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.Conv2DLSTM.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>This provides the user with a way of knowing the initializer keys that
are available without having to instantiate a sonnet module. Subclasses
may override this class method if they need additional arguments to
determine what initializer keys may be provided.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.ConvLSTM">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">ConvLSTM</code><span class="sig-paren">(</span><em>conv_ndims</em>, <em>input_shape</em>, <em>output_channels</em>, <em>kernel_shape</em>, <em>stride=1</em>, <em>rate=1</em>, <em>padding='SAME'</em>, <em>use_bias=True</em>, <em>forget_bias=1.0</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>custom_getter=None</em>, <em>name='conv_lstm'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#ConvLSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ConvLSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Convolutional LSTM.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.ConvLSTM.convolutions">
<code class="descname">convolutions</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ConvLSTM.convolutions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.gated_rnn.ConvLSTM.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>conv_ndims</em>, <em>use_bias=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#ConvLSTM.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ConvLSTM.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>This provides the user with a way of knowing the initializer keys that
are available without having to instantiate a sonnet module. Subclasses
may override this class method if they need additional arguments to
determine what initializer keys may be provided.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.ConvLSTM.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ConvLSTM.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code> indicating the size of the core output.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.ConvLSTM.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ConvLSTM.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of <code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code>s indicating the size of state tensors.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.GRU">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">GRU</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>custom_getter=None</em>, <em>name='gru'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#GRU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>GRU recurrent network cell.</p>
<p>The implementation is based on: <a class="reference external" href="https://arxiv.org/pdf/1412.3555v1.pdf">https://arxiv.org/pdf/1412.3555v1.pdf</a>.</p>
<p>Attributes: state_size: Integer indicating the size of state tensor.
output_size: Integer indicating the size of the core output.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.BH">
<code class="descname">BH</code><em class="property"> = 'bh'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.BH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.BR">
<code class="descname">BR</code><em class="property"> = 'br'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.BR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.BZ">
<code class="descname">BZ</code><em class="property"> = 'bz'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.BZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['uz', 'bh', 'ur', 'wr', 'br', 'wh', 'wz', 'bz', 'uh'])</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.POSSIBLE_KEYS">
<code class="descname">POSSIBLE_KEYS</code><em class="property"> = set(['uz', 'bh', 'ur', 'wr', 'br', 'wh', 'wz', 'bz', 'uh'])</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.POSSIBLE_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.UH">
<code class="descname">UH</code><em class="property"> = 'uh'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.UH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.UR">
<code class="descname">UR</code><em class="property"> = 'ur'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.UR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.UZ">
<code class="descname">UZ</code><em class="property"> = 'uz'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.UZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.WH">
<code class="descname">WH</code><em class="property"> = 'wh'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.WH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.WR">
<code class="descname">WR</code><em class="property"> = 'wr'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.WR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.WZ">
<code class="descname">WZ</code><em class="property"> = 'wz'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.WZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.gated_rnn.GRU.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#GRU.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>The set of all possible initializer keys are: wz: weight for input -&gt;
update cell uz: weight for prev_state -&gt; update cell bz: bias for
update_cell wr: weight for input -&gt; reset cell ur: weight for
prev_state -&gt; reset cell br: bias for reset cell wh: weight for input
-&gt; candidate activation uh: weight for prev_state -&gt; candidate
activation bh: bias for candidate activation</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.GRU.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.GRU.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">HighwayCore</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>num_layers</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>custom_getter=None</em>, <em>name='highwaycore'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#HighwayCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Recurrent Highway Network cell.</p>
<p>The implementation is based on: <a class="reference external" href="https://arxiv.org/pdf/1607.03474v5.pdf">https://arxiv.org/pdf/1607.03474v5.pdf</a>
As per the first lines of section 5 of the reference paper, 1 - T is
used instead of a dedicated C gate.</p>
<p>Attributes: state_size: Integer indicating the size of state tensor.
output_size: Integer indicating the size of the core output.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore.BH">
<code class="descname">BH</code><em class="property"> = 'bh'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore.BH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore.BT">
<code class="descname">BT</code><em class="property"> = 'bt'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore.BT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore.WH">
<code class="descname">WH</code><em class="property"> = 'wh'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore.WH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore.WT">
<code class="descname">WT</code><em class="property"> = 'wt'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore.WT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>num_layers</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#HighwayCore.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>The set of all possible initializer keys are: wt: weight for input -&gt; T
gate wh: weight for input -&gt; H gate wtL: weight for prev state -&gt; T gate
for layer L (indexed from 0) whL: weight for prev state -&gt; H gate for
layer L (indexed from 0) btL: bias for prev state -&gt; T gate for layer L
(indexed from 0) bhL: bias for prev state -&gt; H gate for layer L (indexed
from 0)</p>
<p>Args: num_layers: (int) Number of highway layers. Returns: Set with
strings corresponding to the strings that may be passed to the
constructor.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.HighwayCore.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.HighwayCore.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.LSTM">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">LSTM</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>forget_bias=1.0</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>use_peepholes=False</em>, <em>use_layer_norm=False</em>, <em>hidden_clip_value=None</em>, <em>projection_size=None</em>, <em>cell_clip_value=None</em>, <em>custom_getter=None</em>, <em>name='lstm'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#LSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>LSTM recurrent network cell with optional peepholes &amp; layer
normalization.</p>
<p>The implementation is based on: <a class="reference external" href="http://arxiv.org/abs/1409.2329">http://arxiv.org/abs/1409.2329</a>. We add
forget_bias (default: 1) to the biases of the forget gate in order to
reduce the scale of forgetting in the beginning of the training.</p>
<p>This is described in <a class="reference external" href="https://arxiv.org/pdf/1607.06450.pdf">https://arxiv.org/pdf/1607.06450.pdf</a></p>
<p>Peep-hole connections may optionally be used by specifying a flag in the
constructor. These connections can aid increasing the precision of
output timing, for more details see:</p>
<p><a class="reference external" href="https://research.google.com/pubs/archive/43905.pdf">https://research.google.com/pubs/archive/43905.pdf</a></p>
<p>Projection of the recurrent state, to reduce model parameters and speed
up computation. For more details see:</p>
<p><a class="reference external" href="https://arxiv.org/abs/1402.1128">https://arxiv.org/abs/1402.1128</a></p>
<p>Attributes: state_size: Tuple of <code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code>s indicating the
size of state tensors. output_size: <code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code> indicating the
size of the core output. use_peepholes: Boolean indicating whether
peephole connections are used.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.B_GATES">
<code class="descname">B_GATES</code><em class="property"> = 'b_gates'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.B_GATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['w_f_diag', 'b_gates', 'w_o_diag', 'w_i_diag', 'w_gates', 'w_h_projection'])</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.W_F_DIAG">
<code class="descname">W_F_DIAG</code><em class="property"> = 'w_f_diag'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.W_F_DIAG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.W_GATES">
<code class="descname">W_GATES</code><em class="property"> = 'w_gates'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.W_GATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.W_H_PROJECTION">
<code class="descname">W_H_PROJECTION</code><em class="property"> = 'w_h_projection'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.W_H_PROJECTION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.W_I_DIAG">
<code class="descname">W_I_DIAG</code><em class="property"> = 'w_i_diag'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.W_I_DIAG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.W_O_DIAG">
<code class="descname">W_O_DIAG</code><em class="property"> = 'w_o_diag'</em><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.W_O_DIAG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.gated_rnn.LSTM.get_possible_initializer_keys">
<em class="property">classmethod </em><code class="descname">get_possible_initializer_keys</code><span class="sig-paren">(</span><em>use_peepholes=False</em>, <em>use_projection=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#LSTM.get_possible_initializer_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.get_possible_initializer_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the keys the dictionary of variable initializers may contain.</p>
<p>The set of all possible initializer keys are: w_gates: weight for gates
b_gates: bias of gates w_f_diag: weight for prev_cell -&gt; forget gate
peephole w_i_diag: weight for prev_cell -&gt; input gate peephole
w_o_diag: weight for prev_cell -&gt; output gate peephole</p>
<p>Args: cls:The class. use_peepholes: Boolean that indicates whether
peephole connections are used. use_projection: Boolean that indicates
whether a recurrent projection layer is used.</p>
<p>Returns: Set with strings corresponding to the strings that may be
passed to the constructor.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code> indicating the size of the core output.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple of <code class="docutils literal notranslate"><span class="pre">tf.TensorShape</span></code>s indicating the size of state tensors.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.use_layer_norm">
<code class="descname">use_layer_norm</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.use_layer_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether layer norm is enabled.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTM.use_peepholes">
<code class="descname">use_peepholes</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTM.use_peepholes" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether peephole connections are used.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.LSTMState">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">LSTMState</code><span class="sig-paren">(</span><em>hidden</em>, <em>cell</em><span class="sig-paren">)</span><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTMState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTMState.cell">
<code class="descname">cell</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTMState.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.LSTMState.hidden">
<code class="descname">hidden</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.LSTMState.hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">RecurrentDropoutWrapper</code><span class="sig-paren">(</span><em>core</em>, <em>keep_probs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#RecurrentDropoutWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Wraps an RNNCore so that recurrent dropout can be applied.</p>
<dl class="method">
<dt id="sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper.initial_state">
<code class="descname">initial_state</code><span class="sig-paren">(</span><em>batch_size</em>, <em>dtype=tf.float32</em>, <em>trainable=False</em>, <em>trainable_initializers=None</em>, <em>trainable_regularizers=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#RecurrentDropoutWrapper.initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper.initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the default start state tensor of zeros.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.RecurrentDropoutWrapper.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.gated_rnn.ZoneoutWrapper">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">ZoneoutWrapper</code><span class="sig-paren">(</span><em>core</em>, <em>keep_probs</em>, <em>is_training</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#ZoneoutWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ZoneoutWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Wraps an RNNCore so that zoneout can be applied.</p>
<p>Zoneout was introduced in <a class="reference external" href="https://arxiv.org/abs/1606.01305">https://arxiv.org/abs/1606.01305</a> It consists
of randomly freezing some RNN state in the same way recurrent dropout
would replace this state with zero.</p>
<dl class="method">
<dt id="sonnet.python.modules.gated_rnn.ZoneoutWrapper.initial_state">
<code class="descname">initial_state</code><span class="sig-paren">(</span><em>batch_size</em>, <em>dtype=tf.float32</em>, <em>trainable=False</em>, <em>trainable_initializers=None</em>, <em>trainable_regularizers=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#ZoneoutWrapper.initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ZoneoutWrapper.initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the default start state tensor of zeros.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.ZoneoutWrapper.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ZoneoutWrapper.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.gated_rnn.ZoneoutWrapper.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.gated_rnn.ZoneoutWrapper.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.gated_rnn.highway_core_with_recurrent_dropout">
<code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">highway_core_with_recurrent_dropout</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>num_layers</em>, <em>keep_prob=0.5</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#highway_core_with_recurrent_dropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.highway_core_with_recurrent_dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Highway core with recurrent dropout.</p>
<p>Args: hidden_size: (int) Hidden size dimensionality. num_layers: (int)
Number of highway layers. keep_prob: the probability to keep an entry
when applying dropout. **kwargs: Extra keyword arguments to pass to
the highway core.</p>
<p>Returns: A tuple (train_core, test_core) where train_core is a higway
core with recurrent dropout enabled to be used for training and
test_core is the same highway core without recurrent dropout.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.gated_rnn.lstm_with_recurrent_dropout">
<code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">lstm_with_recurrent_dropout</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>keep_prob=0.5</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#lstm_with_recurrent_dropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.lstm_with_recurrent_dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>LSTM with recurrent dropout.</p>
<p>Args: hidden_size: the LSTM hidden size. keep_prob: the probability to
keep an entry when applying dropout. **kwargs: Extra keyword arguments
to pass to the LSTM.</p>
<p>Returns: A tuple (train_lstm, test_lstm) where train_lstm is an LSTM
with recurrent dropout enabled to be used for training and test_lstm is
the same LSTM without recurrent dropout.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.gated_rnn.lstm_with_zoneout">
<code class="descclassname">sonnet.python.modules.gated_rnn.</code><code class="descname">lstm_with_zoneout</code><span class="sig-paren">(</span><em>hidden_size</em>, <em>keep_prob_c=0.5</em>, <em>keep_prob_h=0.95</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/gated_rnn.html#lstm_with_zoneout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.gated_rnn.lstm_with_zoneout" title="Permalink to this definition">¶</a></dt>
<dd><p>LSTM with recurrent dropout.</p>
<p>Args: hidden_size: the LSTM hidden size. keep_prob_c: the probability
to use the new value of the cell state rather than freezing it.
keep_prob_h: the probability to use the new value of the hidden state
rather than freezing it. **kwargs: Extra keyword arguments to pass to
the LSTM.</p>
<p>Returns: A tuple (train_lstm, test_lstm) where train_lstm is an LSTM
with recurrent dropout enabled to be used for training and test_lstm is
the same LSTM without zoneout.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-gated-rnn-test-module">
<h2>sonnet.python.modules.gated_rnn_test module<a class="headerlink" href="#sonnet-python-modules-gated-rnn-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.layer_norm">
<span id="sonnet-python-modules-layer-norm-module"></span><h2>sonnet.python.modules.layer_norm module<a class="headerlink" href="#module-sonnet.python.modules.layer_norm" title="Permalink to this headline">¶</a></h2>
<p>Layer normalization module for Sonnet.</p>
<p>This contains the module LayerNorm, which performs layer normalization
on its inputs.</p>
<p>Original paper: <a class="reference external" href="https://arxiv.org/abs/1607.06450">https://arxiv.org/abs/1607.06450</a>.</p>
<dl class="class">
<dt id="sonnet.python.modules.layer_norm.LayerNorm">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.layer_norm.</code><code class="descname">LayerNorm</code><span class="sig-paren">(</span><em>eps=1e-05</em>, <em>initializers=None</em>, <em>partitioners=None</em>, <em>regularizers=None</em>, <em>name='layer_norm'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/layer_norm.html#LayerNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Layer normalization module.</p>
<p>Implementation based on: <a class="reference external" href="https://arxiv.org/abs/1607.06450">https://arxiv.org/abs/1607.06450</a></p>
<p>This module transforms input x into:</p>
<p>outputs = gamma * (x - mu) / sigma + beta</p>
<p>where mu and sigma are respectively the mean and standard deviation of
x. Gamma and beta are trainable parameters for scaling and shifting
respectively.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.BETA">
<code class="descname">BETA</code><em class="property"> = 'beta'</em><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.BETA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.GAMMA">
<code class="descname">GAMMA</code><em class="property"> = 'gamma'</em><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.GAMMA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.POSSIBLE_INITIALIZER_KEYS">
<code class="descname">POSSIBLE_INITIALIZER_KEYS</code><em class="property"> = set(['beta', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.POSSIBLE_INITIALIZER_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.POSSIBLE_KEYS">
<code class="descname">POSSIBLE_KEYS</code><em class="property"> = set(['beta', 'gamma'])</em><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.POSSIBLE_KEYS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.beta">
<code class="descname">beta</code><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.beta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.gamma">
<code class="descname">gamma</code><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.initializers">
<code class="descname">initializers</code><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.initializers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.partitioners">
<code class="descname">partitioners</code><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.partitioners" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.layer_norm.LayerNorm.regularizers">
<code class="descname">regularizers</code><a class="headerlink" href="#sonnet.python.modules.layer_norm.LayerNorm.regularizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.layer_norm.create_beta_initializer">
<code class="descclassname">sonnet.python.modules.layer_norm.</code><code class="descname">create_beta_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/layer_norm.html#create_beta_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.layer_norm.create_beta_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">beta</span></code> in layer norm.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.layer_norm.create_gamma_initializer">
<code class="descclassname">sonnet.python.modules.layer_norm.</code><code class="descname">create_gamma_initializer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/layer_norm.html#create_gamma_initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.layer_norm.create_gamma_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default initializer for the <code class="docutils literal notranslate"><span class="pre">gamma</span></code> in layer norm.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-layer-norm-test-module">
<h2>sonnet.python.modules.layer_norm_test module<a class="headerlink" href="#sonnet-python-modules-layer-norm-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.pondering_rnn">
<span id="sonnet-python-modules-pondering-rnn-module"></span><h2>sonnet.python.modules.pondering_rnn module<a class="headerlink" href="#module-sonnet.python.modules.pondering_rnn" title="Permalink to this headline">¶</a></h2>
<p>Cores for RNNs with varying number of unrolls.</p>
<p>This file contains implementations for: * ACT (Adaptive Computation
Time)</p>
<dl class="class">
<dt id="sonnet.python.modules.pondering_rnn.ACTCore">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.pondering_rnn.</code><code class="descname">ACTCore</code><span class="sig-paren">(</span><em>core</em>, <em>output_size</em>, <em>threshold</em>, <em>get_state_for_halting</em>, <em>name='act_core'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/pondering_rnn.html#ACTCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.pondering_rnn.ACTCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Adaptive computation time core.</p>
<p>Implementation of the model described in “Adaptive Computation Time for
Recurrent Neural Networks” paper, <a class="reference external" href="https://arxiv.org/abs/1603.08983">https://arxiv.org/abs/1603.08983</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ACTCore</span></code> incorporates the pondering RNN of ACT, with different
computation times for each element in the mini batch. Each pondering
step is performed by the <code class="docutils literal notranslate"><span class="pre">core</span></code> passed to the constructor of
<code class="docutils literal notranslate"><span class="pre">ACTCore</span></code>.</p>
<p>The output of the <code class="docutils literal notranslate"><span class="pre">ACTCore</span></code> is made of
<code class="docutils literal notranslate"><span class="pre">(act_out,</span> <span class="pre">(iteration,</span> <span class="pre">remainder)</span></code>, where</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">iteration</span></code> counts the number of pondering step in each batch
element;</li>
<li><code class="docutils literal notranslate"><span class="pre">remainder</span></code> is the remainder as defined in the ACT paper;</li>
<li><code class="docutils literal notranslate"><span class="pre">act_out</span></code> is the weighted average output of all pondering steps
(see ACT paper for more info).</li>
</ul>
<dl class="attribute">
<dt id="sonnet.python.modules.pondering_rnn.ACTCore.batch_size">
<code class="descname">batch_size</code><a class="headerlink" href="#sonnet.python.modules.pondering_rnn.ACTCore.batch_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.pondering_rnn.ACTCore.dtype">
<code class="descname">dtype</code><a class="headerlink" href="#sonnet.python.modules.pondering_rnn.ACTCore.dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.pondering_rnn.ACTCore.initial_state">
<code class="descname">initial_state</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/pondering_rnn.html#ACTCore.initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.pondering_rnn.ACTCore.initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the default start state for an RNNCore.</p>
<p>Args: batch_size: An int, or scalar int32 Tensor representing the batch
size. dtype: The data type to use for the state. trainable: Boolean that
indicates whether to learn the initial state. Note that intializers and
regularizers will be ignored if <code class="docutils literal notranslate"><span class="pre">trainable=False</span></code>.
trainable_initializers: An initializer function or nested structure of
functions with same structure as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code> property of the
core, to be used as initializers of the initial state variable.
trainable_regularizers: Optional regularizer function or nested
structure of functions with the same structure as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code>
property of the core, to be used as regularizers of the initial state
variable. As a default, no regularizers are used. A regularizer should
be a function that takes a single <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> as an input and returns a
scalar <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> output, e.g. the L1 and L2 regularizers in
<code class="docutils literal notranslate"><span class="pre">tf.contrib.layers</span></code>. name: Optional string used to prefix the initial
state variable names, in the case of a trainable initial state. If not
provided, defaults to the name of the module.</p>
<p>Returns: A tensor or nested tuple of tensors with same structure and
shape as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code> property of the core.</p>
<p>Raises: ValueError: if the user passes initializers that are not
functions. ValueError: if the user passes regularizers that are not
functions.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.pondering_rnn.ACTCore.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.pondering_rnn.ACTCore.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.pondering_rnn.ACTCore.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.pondering_rnn.ACTCore.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-pondering-rnn-test-module">
<h2>sonnet.python.modules.pondering_rnn_test module<a class="headerlink" href="#sonnet-python-modules-pondering-rnn-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.residual">
<span id="sonnet-python-modules-residual-module"></span><h2>sonnet.python.modules.residual module<a class="headerlink" href="#module-sonnet.python.modules.residual" title="Permalink to this headline">¶</a></h2>
<p>Wrappers to add residual and skip connections to Sonnet modules.</p>
<dl class="class">
<dt id="sonnet.python.modules.residual.Residual">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.residual.</code><code class="descname">Residual</code><span class="sig-paren">(</span><em>base_module</em>, <em>name='residual'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/residual.html#Residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.residual.Residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Adds a residual connection to a base module.</p>
<p>This module wraps a module M, where if M with traditionally output M(X),
Residual(M)(x) = M(x) + x.</p>
</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.residual.ResidualCore">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.residual.</code><code class="descname">ResidualCore</code><span class="sig-paren">(</span><em>base_core</em>, <em>name='residual_core'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/residual.html#ResidualCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.residual.ResidualCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Adds a residual connection to a base RNN core.</p>
<p>This module wraps a module M, where if M with traditionally output M(X),
Residual(M)(x) = M(x) + x.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.residual.ResidualCore.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.residual.ResidualCore.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.residual.ResidualCore.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.residual.ResidualCore.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.residual.SkipConnectionCore">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.residual.</code><code class="descname">SkipConnectionCore</code><span class="sig-paren">(</span><em>base_core</em>, <em>input_shape=None</em>, <em>name='skip_connection_core'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/residual.html#SkipConnectionCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.residual.SkipConnectionCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.rnn_core.RNNCore" title="sonnet.python.modules.rnn_core.RNNCore"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.rnn_core.RNNCore</span></code></a></p>
<p>Adds a skip connection to the base RNN core.</p>
<p>This concatenates the input to the output of the base core.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.residual.SkipConnectionCore.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.residual.SkipConnectionCore.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.residual.SkipConnectionCore.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.residual.SkipConnectionCore.state_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-residual-test-module">
<h2>sonnet.python.modules.residual_test module<a class="headerlink" href="#sonnet-python-modules-residual-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.rnn_core">
<span id="sonnet-python-modules-rnn-core-module"></span><h2>sonnet.python.modules.rnn_core module<a class="headerlink" href="#module-sonnet.python.modules.rnn_core" title="Permalink to this headline">¶</a></h2>
<p>Base class for TensorFlow Sonnet recurrent cores.</p>
<p>This file contains the Abstract Base Class for defining Recurrent Cores
in TensorFlow. A Recurrent Core is an object that holds the properties
of other <code class="docutils literal notranslate"><span class="pre">snt.Module</span></code>s and also satisfies the interface of any
RNNCell in tensorflow.</p>
<dl class="class">
<dt id="sonnet.python.modules.rnn_core.RNNCore">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.rnn_core.</code><code class="descname">RNNCore</code><span class="sig-paren">(</span><em>_sentinel=None</em>, <em>custom_getter=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/rnn_core.html#RNNCore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.rnn_core.RNNCore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Superclass for Recurrent Neural Network Cores.</p>
<p>This class defines the basic functionality that every core should
implement, mainly the <code class="docutils literal notranslate"><span class="pre">initial_state</span></code> method which will return an
example of their initial state. It also inherits from the two interfaces
it should be compatible with, which are <code class="docutils literal notranslate"><span class="pre">snt.Module</span></code> and
<code class="docutils literal notranslate"><span class="pre">tf.contrib.rnn.RNNCell</span></code>.</p>
<p>As with any other <code class="docutils literal notranslate"><span class="pre">snt.Module</span></code> any subclass must implement a
<code class="docutils literal notranslate"><span class="pre">_build</span></code> method that constructs the graph that corresponds to a core.
Such a <code class="docutils literal notranslate"><span class="pre">_build</span></code> method should always have the same interface, which is
the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="p">,</span> <span class="n">next_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">prev_state</span><span class="p">)</span>
</pre></div>
</div>
<p>where output, next_state, input, and prev_state are arbitrarily nested
tensors. Such structures can be defined according to the following
grammar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">element</span><span class="o">*</span><span class="p">)</span> <span class="o">|</span> <span class="nb">list</span><span class="p">(</span><span class="n">element</span><span class="o">*</span><span class="p">)</span> <span class="o">|</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</pre></div>
</div>
<p>This class is to be used with tensorflow containers such as <code class="docutils literal notranslate"><span class="pre">rnn</span></code> in
tensorflow.python.ops.rnn. These containers only accept
<code class="docutils literal notranslate"><span class="pre">tf.contrib.rnn.RNNCell</span></code> objects, hence the need to comply with its
interface. This way, all the RNNCores should expose a <code class="docutils literal notranslate"><span class="pre">state_size</span></code> and
<code class="docutils literal notranslate"><span class="pre">output_size</span></code> properties.</p>
<dl class="method">
<dt id="sonnet.python.modules.rnn_core.RNNCore.initial_state">
<code class="descname">initial_state</code><span class="sig-paren">(</span><em>batch_size</em>, <em>dtype=tf.float32</em>, <em>trainable=False</em>, <em>trainable_initializers=None</em>, <em>trainable_regularizers=None</em>, <em>name=None</em>, <em>**unused_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/rnn_core.html#RNNCore.initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.rnn_core.RNNCore.initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the default start state for an RNNCore.</p>
<p>Args: batch_size: An int, or scalar int32 Tensor representing the batch
size. dtype: The data type to use for the state. trainable: Boolean that
indicates whether to learn the initial state. Note that intializers and
regularizers will be ignored if <code class="docutils literal notranslate"><span class="pre">trainable=False</span></code>.
trainable_initializers: An initializer function or nested structure of
functions with same structure as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code> property of the
core, to be used as initializers of the initial state variable.
trainable_regularizers: Optional regularizer function or nested
structure of functions with the same structure as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code>
property of the core, to be used as regularizers of the initial state
variable. As a default, no regularizers are used. A regularizer should
be a function that takes a single <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> as an input and returns a
scalar <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> output, e.g. the L1 and L2 regularizers in
<code class="docutils literal notranslate"><span class="pre">tf.contrib.layers</span></code>. name: Optional string used to prefix the initial
state variable names, in the case of a trainable initial state. If not
provided, defaults to the name of the module.</p>
<p>Returns: A tensor or nested tuple of tensors with same structure and
shape as the <code class="docutils literal notranslate"><span class="pre">state_size</span></code> property of the core.</p>
<p>Raises: ValueError: if the user passes initializers that are not
functions. ValueError: if the user passes regularizers that are not
functions.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.rnn_core.RNNCore.output_size">
<code class="descname">output_size</code><a class="headerlink" href="#sonnet.python.modules.rnn_core.RNNCore.output_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer or TensorShape: size of outputs produced by this cell.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.rnn_core.RNNCore.state_size">
<code class="descname">state_size</code><a class="headerlink" href="#sonnet.python.modules.rnn_core.RNNCore.state_size" title="Permalink to this definition">¶</a></dt>
<dd><p>size(s) of state(s) used by this cell.</p>
<p>It can be represented by an Integer, a TensorShape or a tuple of
Integers or TensorShapes.</p>
</dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.rnn_core.RNNCore.zero_state">
<code class="descname">zero_state</code><span class="sig-paren">(</span><em>batch_size</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/rnn_core.html#RNNCore.zero_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.rnn_core.RNNCore.zero_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Return zero-filled state tensor(s).</p>
<p>Args: batch_size: int, float, or unit Tensor representing the batch
size. dtype: the data type to use for the state.</p>
<p>Returns: If <code class="docutils literal notranslate"><span class="pre">state_size</span></code> is an int or TensorShape, then the return
value is a <code class="docutils literal notranslate"><span class="pre">N-D</span></code> tensor of shape <code class="docutils literal notranslate"><span class="pre">[batch_size</span> <span class="pre">x</span> <span class="pre">state_size]</span></code> filled
with zeros.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">state_size</span></code> is a nested list or tuple, then the return value is a
nested list or tuple (of the same structure) of <code class="docutils literal notranslate"><span class="pre">2-D</span></code> tensors with the
shapes <code class="docutils literal notranslate"><span class="pre">[batch_size</span> <span class="pre">x</span> <span class="pre">s]</span></code> for each s in <code class="docutils literal notranslate"><span class="pre">state_size</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.rnn_core.TrainableInitialState">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.rnn_core.</code><code class="descname">TrainableInitialState</code><span class="sig-paren">(</span><em>initial_state</em>, <em>mask=None</em>, <em>name='trainable_initial_state'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/rnn_core.html#TrainableInitialState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.rnn_core.TrainableInitialState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Helper Module that creates a learnable initial state for an RNNCore.</p>
<p>This class receives an example (possibly nested) initial state of an
RNNCore, and returns a state that has the same shape, structure, and
values, but is trainable. Additionally, the user may specify a boolean
mask that indicates which parts of the initial state should be
trainable.</p>
<p>This allows users to train an unrolled RNNCore with a learnable initial
state in the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">core</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># Any RNNCore module object.</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">initial_state</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<span class="n">trainable_initial_state</span> <span class="o">=</span> <span class="n">snt</span><span class="o">.</span><span class="n">TrainableInitialState</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)()</span>
<span class="n">output</span><span class="p">,</span> <span class="n">final_state</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">dynamic_rnn</span><span class="p">(</span>
    <span class="n">core</span><span class="p">,</span> <span class="n">input_sequence</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">trainable_initial_state</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.rnn_core.trainable_initial_state">
<code class="descclassname">sonnet.python.modules.rnn_core.</code><code class="descname">trainable_initial_state</code><span class="sig-paren">(</span><em>batch_size</em>, <em>state_size</em>, <em>dtype</em>, <em>initializers=None</em>, <em>regularizers=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/rnn_core.html#trainable_initial_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.rnn_core.trainable_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an initial state consisting of trainable variables.</p>
<p>The trainable variables are created with the same shapes as the elements
of <code class="docutils literal notranslate"><span class="pre">state_size</span></code> and are tiled to produce an initial state.</p>
<p>Args: batch_size: An int, or scalar int32 Tensor representing the batch
size. state_size: A <code class="docutils literal notranslate"><span class="pre">TensorShape</span></code> or nested tuple of
<code class="docutils literal notranslate"><span class="pre">TensorShape</span></code>s to use for the shape of the trainable variables.
dtype: The data type used to create the variables and thus initial
state. initializers: An optional container of the same structure as
<code class="docutils literal notranslate"><span class="pre">state_size</span></code> containing initializers for the variables. regularizers:
An optional container of the same structure as <code class="docutils literal notranslate"><span class="pre">state_size</span></code> containing
regularizers for the variables. name: optional string used to prefix the
initial state variable names.</p>
<p>Returns: A <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> or nested tuple of <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>s with the same
size and structure as <code class="docutils literal notranslate"><span class="pre">state_size</span></code>, where each <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> is a tiled
trainable <code class="docutils literal notranslate"><span class="pre">Variable</span></code>.</p>
<p>Raises: ValueError: if the user passes initializers that are not
functions. ValueError: if the user passes regularizers that are not
functions.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-rnn-core-test-module">
<h2>sonnet.python.modules.rnn_core_test module<a class="headerlink" href="#sonnet-python-modules-rnn-core-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.scale_gradient">
<span id="sonnet-python-modules-scale-gradient-module"></span><h2>sonnet.python.modules.scale_gradient module<a class="headerlink" href="#module-sonnet.python.modules.scale_gradient" title="Permalink to this headline">¶</a></h2>
<p>Tensorflow op that scales gradient for backwards pass.</p>
<dl class="function">
<dt id="sonnet.python.modules.scale_gradient.scale_gradient">
<code class="descclassname">sonnet.python.modules.scale_gradient.</code><code class="descname">scale_gradient</code><span class="sig-paren">(</span><em>net</em>, <em>scale</em>, <em>name='scale_gradient'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/scale_gradient.html#scale_gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.scale_gradient.scale_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Scales gradients for the backwards pass.</p>
<p>This might be used to, for example, allow one part of a model to learn
at a lower rate than the rest.</p>
<p>WARNING: Think carefully about how your optimizer works. If, for
example, you use rmsprop, the gradient is always rescaled (with some
additional epsilon) towards unity. This means <code class="docutils literal notranslate"><span class="pre">scale_gradient</span></code> won’t
have the effect of lowering the learning rate.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">scale</span></code> is <code class="docutils literal notranslate"><span class="pre">0.0</span></code>, this op reduces to <code class="docutils literal notranslate"><span class="pre">tf.stop_gradient</span></code>. If
<code class="docutils literal notranslate"><span class="pre">scale</span></code> is <code class="docutils literal notranslate"><span class="pre">1.0</span></code>, this op reduces to <code class="docutils literal notranslate"><span class="pre">tf.identity</span></code>.</p>
<p>Args: net: A <code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code>. scale: The scale factor for the gradient on
the backwards pass. name: A name for the operation (optional).</p>
<p>Returns: A <code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code> with the same type as the input tensor.</p>
<p>Raises: ValueError: If <code class="docutils literal notranslate"><span class="pre">net</span></code> dtype is non-float and <code class="docutils literal notranslate"><span class="pre">scale</span></code> is not
zero or one.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-scale-gradient-test-module">
<h2>sonnet.python.modules.scale_gradient_test module<a class="headerlink" href="#sonnet-python-modules-scale-gradient-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.sequential">
<span id="sonnet-python-modules-sequential-module"></span><h2>sonnet.python.modules.sequential module<a class="headerlink" href="#module-sonnet.python.modules.sequential" title="Permalink to this headline">¶</a></h2>
<p>Sequential Module for TensorFlow snt.</p>
<p>A Module that wraps a list of other modules and ops, connecting the
output of each to the input of the next.</p>
<dl class="class">
<dt id="sonnet.python.modules.sequential.Sequential">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.sequential.</code><code class="descname">Sequential</code><span class="sig-paren">(</span><em>layers</em>, <em>name='sequential'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/sequential.html#Sequential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.sequential.Sequential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Builds a module out of a sequence of callables.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> is limited in the range of possible
architectures it can handle. This is a deliberate design decision;
<code class="docutils literal notranslate"><span class="pre">Sequential</span></code> is only meant to be used for the simple case of fusing
together modules/ops where the input of a particular module/op is the
output of the previous one. Another restriction is that it is not
possible to have extra arguments in the <code class="docutils literal notranslate"><span class="pre">_build</span></code> method that are
passed to the constituents of the module - for example, if there is a
<code class="docutils literal notranslate"><span class="pre">BatchNorm</span></code> module in <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> and the user wishes to switch the
<code class="docutils literal notranslate"><span class="pre">is_training</span></code> flag. If this is the desired use case, the recommended
solution is to use <code class="docutils literal notranslate"><span class="pre">snt.Module</span></code> to wrap a custom function, as shown in
the following example:</p>
<p><a class="reference external" href="https://github.com/deepmind/sonnet/examples/module_with_build_args.py">https://github.com/deepmind/sonnet/examples/module_with_build_args.py</a></p>
<dl class="method">
<dt id="sonnet.python.modules.sequential.Sequential.get_variables">
<code class="descname">get_variables</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/sequential.html#Sequential.get_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.sequential.Sequential.get_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide a warning that get_variables on Sequential always returns ().</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.sequential.Sequential.layers">
<code class="descname">layers</code><a class="headerlink" href="#sonnet.python.modules.sequential.Sequential.layers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-sequential-test-module">
<h2>sonnet.python.modules.sequential_test module<a class="headerlink" href="#sonnet-python-modules-sequential-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.spatial_transformer">
<span id="sonnet-python-modules-spatial-transformer-module"></span><h2>sonnet.python.modules.spatial_transformer module<a class="headerlink" href="#module-sonnet.python.modules.spatial_transformer" title="Permalink to this headline">¶</a></h2>
<p>“Implementation of Spatial Transformer networks core components.</p>
<dl class="class">
<dt id="sonnet.python.modules.spatial_transformer.AffineGridWarper">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.spatial_transformer.</code><code class="descname">AffineGridWarper</code><span class="sig-paren">(</span><em>source_shape</em>, <em>output_shape</em>, <em>constraints=None</em>, <em>name='affine_grid_warper'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineGridWarper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineGridWarper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.spatial_transformer.GridWarper" title="sonnet.python.modules.spatial_transformer.GridWarper"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.spatial_transformer.GridWarper</span></code></a></p>
<p>Affine Grid Warper class.</p>
<p>The affine grid warper generates a reference grid of n-dimensional
points and warps it via an affine transormation model determined by an
input parameter Tensor. Some of the transformation parameters can be
fixed at construction time via an <code class="docutils literal notranslate"><span class="pre">AffineWarpConstraints</span></code> object.</p>
<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.AffineGridWarper.constraints">
<code class="descname">constraints</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineGridWarper.constraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sonnet.python.modules.spatial_transformer.AffineGridWarper.inverse">
<code class="descname">inverse</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineGridWarper.inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineGridWarper.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <code class="docutils literal notranslate"><span class="pre">sonnet</span></code> module to compute inverse affine transforms.</p>
<p>The function first assembles a network that given the constraints of the
current AffineGridWarper and a set of input parameters, retrieves the
coefficients of the corresponding inverse affine transform, then feeds
its output into a new AffineGridWarper setup to correctly warp the
<code class="docutils literal notranslate"><span class="pre">output</span></code> space into the <code class="docutils literal notranslate"><span class="pre">source</span></code> space.</p>
<p>Args: name: Name of module implementing the inverse grid transformation.</p>
<p>Returns: A <code class="docutils literal notranslate"><span class="pre">sonnet</span></code> module performing the inverse affine transform of
a reference grid of points via an AffineGridWarper module.</p>
<p>Raises: tf.errors.UnimplementedError: If the function is called on a non
2D instance of AffineGridWarper.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.spatial_transformer.</code><code class="descname">AffineWarpConstraints</code><span class="sig-paren">(</span><em>constraints=((None</em>, <em>None</em>, <em>None)</em>, <em>(None</em>, <em>None</em>, <em>None))</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Affine warp contraints class.</p>
<p><code class="docutils literal notranslate"><span class="pre">AffineWarpConstraints</span></code> allow for very succinct definitions of
constraints on the values of entries in affine transform matrices.</p>
<dl class="method">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.combine_with">
<code class="descname">combine_with</code><span class="sig-paren">(</span><em>additional_constraints</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.combine_with"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.combine_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines two sets of constraints into a coherent single set.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.constraints">
<code class="descname">constraints</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.constraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.mask">
<code class="descname">mask</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.no_constraints">
<em class="property">classmethod </em><code class="descname">no_constraints</code><span class="sig-paren">(</span><em>num_dim=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.no_constraints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.no_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Empty set of constraints for a num_dim-ensional affine transform.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.no_shear_2d">
<em class="property">classmethod </em><code class="descname">no_shear_2d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.no_shear_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.no_shear_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.no_shear_3d">
<em class="property">classmethod </em><code class="descname">no_shear_3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.no_shear_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.no_shear_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns contraints on shear components of affine transform in 3d.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.num_dim">
<code class="descname">num_dim</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.num_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.num_free_params">
<code class="descname">num_free_params</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.num_free_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.scale_2d">
<em class="property">classmethod </em><code class="descname">scale_2d</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.scale_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.scale_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns contraints on scaling components of affine transform in 2d.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.scale_3d">
<em class="property">classmethod </em><code class="descname">scale_3d</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.scale_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.scale_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns contraints on scaling components of affine transform in 3d.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.shear_2d">
<em class="property">classmethod </em><code class="descname">shear_2d</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.shear_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.shear_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns contraints on shear components of affine transform in 2d.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.translation_2d">
<em class="property">classmethod </em><code class="descname">translation_2d</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.translation_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.translation_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign contraints on translation components of affine transform in 2d.</p>
</dd></dl>

<dl class="classmethod">
<dt id="sonnet.python.modules.spatial_transformer.AffineWarpConstraints.translation_3d">
<em class="property">classmethod </em><code class="descname">translation_3d</code><span class="sig-paren">(</span><em>x=None</em>, <em>y=None</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#AffineWarpConstraints.translation_3d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.AffineWarpConstraints.translation_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign contraints on translation components of affine transform in 3d.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sonnet.python.modules.spatial_transformer.GridWarper">
<em class="property">class </em><code class="descclassname">sonnet.python.modules.spatial_transformer.</code><code class="descname">GridWarper</code><span class="sig-paren">(</span><em>source_shape</em>, <em>output_shape</em>, <em>num_coeff</em>, <em>name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/spatial_transformer.html#GridWarper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.GridWarper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sonnet.python.modules.base.AbstractModule" title="sonnet.python.modules.base.AbstractModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sonnet.python.modules.base.AbstractModule</span></code></a></p>
<p>Grid warper interface class.</p>
<p>An object implementing the <code class="docutils literal notranslate"><span class="pre">GridWarper</span></code> interface generates a
reference grid of feature points at construction time, and warps it via
a parametric transformation model, specified at run time by an input
parameter Tensor. Grid warpers must then implement a <code class="docutils literal notranslate"><span class="pre">create_features</span></code>
function used to generate the reference grid to be warped in the forward
pass (according to a determined warping model).</p>
<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.GridWarper.n_coeff">
<code class="descname">n_coeff</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.GridWarper.n_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of coefficients of warping function.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.GridWarper.output_shape">
<code class="descname">output_shape</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.GridWarper.output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple containing the shape of the output grid.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.GridWarper.psi">
<code class="descname">psi</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.GridWarper.psi" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of features used to compute the grid warp.</p>
</dd></dl>

<dl class="attribute">
<dt id="sonnet.python.modules.spatial_transformer.GridWarper.source_shape">
<code class="descname">source_shape</code><a class="headerlink" href="#sonnet.python.modules.spatial_transformer.GridWarper.source_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple containing the shape of the source signal.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-spatial-transformer-test-module">
<h2>sonnet.python.modules.spatial_transformer_test module<a class="headerlink" href="#sonnet-python-modules-spatial-transformer-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules.util">
<span id="sonnet-python-modules-util-module"></span><h2>sonnet.python.modules.util module<a class="headerlink" href="#module-sonnet.python.modules.util" title="Permalink to this headline">¶</a></h2>
<p>Utility functions for dealing with Sonnet Modules.</p>
<dl class="function">
<dt id="sonnet.python.modules.util.check_initializers">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">check_initializers</code><span class="sig-paren">(</span><em>initializers</em>, <em>keys</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#check_initializers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.check_initializers" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the given initializers.</p>
<p>This checks that <code class="docutils literal notranslate"><span class="pre">initializers</span></code> is a dictionary that only contains
keys in <code class="docutils literal notranslate"><span class="pre">keys</span></code>, and furthermore the entries in <code class="docutils literal notranslate"><span class="pre">initializers</span></code> are
functions or further dictionaries (the latter used, for example, in
passing initializers to modules inside modules) that must satisfy the
same constraints.</p>
<p>Args: initializers: Dictionary of initializers (allowing nested
dictionaries) or None. keys: Iterable of valid keys for
<code class="docutils literal notranslate"><span class="pre">initializers</span></code>.</p>
<p>Returns: Copy of checked dictionary of initializers. If
<code class="docutils literal notranslate"><span class="pre">initializers=None</span></code>, an empty dictionary will be returned.</p>
<p>Raises: KeyError: If an initializer is provided for a key not in
<code class="docutils literal notranslate"><span class="pre">keys</span></code>. TypeError: If a provided initializer is not a callable
function, or <code class="docutils literal notranslate"><span class="pre">initializers</span></code> is not a Mapping.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.check_partitioners">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">check_partitioners</code><span class="sig-paren">(</span><em>partitioners</em>, <em>keys</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#check_partitioners"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.check_partitioners" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the given partitioners.</p>
<p>This checks that <code class="docutils literal notranslate"><span class="pre">partitioners</span></code> is a dictionary that only contains
keys in <code class="docutils literal notranslate"><span class="pre">keys</span></code>, and furthermore the entries in <code class="docutils literal notranslate"><span class="pre">partitioners</span></code> are
functions or further dictionaries (the latter used, for example, in
passing partitioners to modules inside modules) that must satisfy the
same constraints.</p>
<p>Args: partitioners: Dictionary of partitioners (allowing nested
dictionaries) or None. keys: Iterable of valid keys for
<code class="docutils literal notranslate"><span class="pre">partitioners</span></code>.</p>
<p>Returns: Checked dictionary of partitioners. If <code class="docutils literal notranslate"><span class="pre">partitioners=None</span></code>,
an empty dictionary will be returned.</p>
<p>Raises: KeyError: If an partitioner is provided for a key not in
<code class="docutils literal notranslate"><span class="pre">keys</span></code>. TypeError: If a provided partitioner is not a callable
function, or <code class="docutils literal notranslate"><span class="pre">partitioners</span></code> is not a Mapping.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.check_regularizers">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">check_regularizers</code><span class="sig-paren">(</span><em>regularizers</em>, <em>keys</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#check_regularizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.check_regularizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the given regularizers.</p>
<p>This checks that <code class="docutils literal notranslate"><span class="pre">regularizers</span></code> is a dictionary that only contains
keys in <code class="docutils literal notranslate"><span class="pre">keys</span></code>, and furthermore the entries in <code class="docutils literal notranslate"><span class="pre">regularizers</span></code> are
functions or further dictionaries (the latter used, for example, in
passing regularizers to modules inside modules) that must satisfy the
same constraints.</p>
<p>Args: regularizers: Dictionary of regularizers (allowing nested
dictionaries) or None. keys: Iterable of valid keys for
<code class="docutils literal notranslate"><span class="pre">regularizers</span></code>.</p>
<p>Returns: Copy of checked dictionary of regularizers. If
<code class="docutils literal notranslate"><span class="pre">regularizers=None</span></code>, an empty dictionary will be returned.</p>
<p>Raises: KeyError: If an regularizers is provided for a key not in
<code class="docutils literal notranslate"><span class="pre">keys</span></code>. TypeError: If a provided regularizer is not a callable
function, or <code class="docutils literal notranslate"><span class="pre">regularizers</span></code> is not a Mapping.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.custom_getter_router">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">custom_getter_router</code><span class="sig-paren">(</span><em>custom_getter_map</em>, <em>name_fn</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#custom_getter_router"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.custom_getter_router" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a custom getter than matches requests to dict of custom getters.</p>
<p>Custom getters are callables which implement the [custom getter API]
(<a class="reference external" href="https://www.tensorflow.org/versions/r1.0/api_docs/python/tf/get_variable">https://www.tensorflow.org/versions/r1.0/api_docs/python/tf/get_variable</a>).</p>
<p>The returned custom getter dispatches calls based on pattern matching
the name of the requested variable to the keys of custom_getter_map.
For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;.*/w&quot;</span><span class="p">:</span> <span class="n">snt</span><span class="o">.</span><span class="n">custom_getters</span><span class="o">.</span><span class="n">stop_gradient</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>will match all variables named with the suffix “/w”. The <code class="docutils literal notranslate"><span class="pre">name_fn</span></code> is
provided to allow processing of the name, such as stripping off a scope
prefix before matching.</p>
<p>Args: custom_getter_map: Mapping of regular expressions to custom
getter functions. name_fn: Callable to map variable name through before
matching to regular expressions. This might, for example, strip off a
scope prefix.</p>
<p>Returns: A custom getter.</p>
<p>Raises: TypeError: If an entry in <code class="docutils literal notranslate"><span class="pre">custom_getter_map</span></code> is not a
callable function.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.format_variable_map">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">format_variable_map</code><span class="sig-paren">(</span><em>variable_map</em>, <em>join_lines=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#format_variable_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.format_variable_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a key-to-variable map and formats it as a table.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.format_variables">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">format_variables</code><span class="sig-paren">(</span><em>variables</em>, <em>join_lines=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#format_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.format_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a collection of variables and formats it as a table.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.get_normalized_variable_map">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">get_normalized_variable_map</code><span class="sig-paren">(</span><em>scope_or_module</em>, <em>collection='variables'</em>, <em>context=None</em>, <em>group_sliced_variables=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#get_normalized_variable_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.get_normalized_variable_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds map of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>s in scope or module with normalized
names.</p>
<p>The names of the variables are normalized to remove the scope prefix.</p>
<p>Args: scope_or_module: Scope or module to build map from. collection:
Collection to restrict query to. By default this is
<code class="docutils literal notranslate"><span class="pre">tf.Graphkeys.VARIABLES</span></code>, which includes non-trainable variables such
as moving averages. context: Scope or module, identical to or parent of
<code class="docutils literal notranslate"><span class="pre">scope</span></code>. If given, this will be used as the stripped prefix. By
default <code class="docutils literal notranslate"><span class="pre">None</span></code>, which means <code class="docutils literal notranslate"><span class="pre">context=scope</span></code>.
group_sliced_variables: Boolean, if set to True, sliced variables are
grouped together in the returned map; if set to False, each partition of
a sliced variable is a separate (key, value) pair.</p>
<p>Returns: Dictionary mapping normalized variable name to <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>,
or a list of <code class="docutils literal notranslate"><span class="pre">tf.Variables</span></code> if the variable is a sliced (partitioned)
variable.</p>
<p>Raises: ValueError: If <code class="docutils literal notranslate"><span class="pre">context</span></code> is given but is not a proper prefix
of <code class="docutils literal notranslate"><span class="pre">scope</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.get_saver">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">get_saver</code><span class="sig-paren">(</span><em>scope</em>, <em>collections=('variables'</em>, <em>)</em>, <em>context=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#get_saver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.get_saver" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a <code class="docutils literal notranslate"><span class="pre">tf.train.Saver</span></code> for the scope or module, with normalized
names.</p>
<p>The names of the variables are normalized to remove the scope prefix.
This allows the same variables to be restored into another similar scope
or module using a complementary <code class="docutils literal notranslate"><span class="pre">tf.train.Saver</span></code> object.</p>
<p>Args: scope: Scope or module. Variables within will be saved or
restored. collections: Sequence of collections of variables to restrict
<code class="docutils literal notranslate"><span class="pre">tf.train.Saver</span></code> to. By default this is
<code class="docutils literal notranslate"><span class="pre">tf.GraphKeys.GLOBAL_VARIABLES</span></code> which includes moving averages
variables as well as trainable variables. context: Scope or module,
identical to or parent of <code class="docutils literal notranslate"><span class="pre">scope</span></code>. If given, this will be used as the
stripped prefix. **kwargs: Extra keyword arguments to pass to
tf.train.Saver.</p>
<p>Returns: A <code class="docutils literal notranslate"><span class="pre">tf.train.Saver</span></code> object for Variables in the scope or
module.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.get_variable_scope_name">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">get_variable_scope_name</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#get_variable_scope_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.get_variable_scope_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the variable scope indicated by the given value.</p>
<p>Args: value: String, variable scope, or object with <code class="docutils literal notranslate"><span class="pre">variable_scope</span></code>
attribute (e.g., Sonnet module).</p>
<p>Returns: The name (a string) of the corresponding variable scope.</p>
<p>Raises: ValueError: If <code class="docutils literal notranslate"><span class="pre">value</span></code> does not identify a variable scope.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.get_variables_in_module">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">get_variables_in_module</code><span class="sig-paren">(</span><em>module</em>, <em>collection='trainable_variables'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#get_variables_in_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.get_variables_in_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns tuple of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>s declared inside an <code class="docutils literal notranslate"><span class="pre">snt.Module</span></code>.</p>
<p>Note that this operates by searching the variable scope a module
contains, and so does not know about any modules which were constructed
elsewhere but used inside this module.</p>
<p>Args: module: <code class="docutils literal notranslate"><span class="pre">snt.Module</span></code> instance to query the scope of. collection:
Collection to restrict query to. By default this is
<code class="docutils literal notranslate"><span class="pre">tf.Graphkeys.TRAINABLE_VARIABLES</span></code>, which doesn’t include
non-trainable variables such as moving averages.</p>
<p>Returns: A tuple of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code> objects.</p>
<p>Raises: NotConnectedError: If the module is not connected to the Graph.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.get_variables_in_scope">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">get_variables_in_scope</code><span class="sig-paren">(</span><em>scope</em>, <em>collection='trainable_variables'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#get_variables_in_scope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.get_variables_in_scope" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>s in a scope for a given collection.</p>
<p>Args: scope: <code class="docutils literal notranslate"><span class="pre">tf.VariableScope</span></code> or string to retrieve variables from.
collection: Collection to restrict query to. By default this is
<code class="docutils literal notranslate"><span class="pre">tf.Graphkeys.TRAINABLE_VARIABLES</span></code>, which doesn’t include
non-trainable variables such as moving averages.</p>
<p>Returns: A tuple of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code> objects.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.has_variable_scope">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">has_variable_scope</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#has_variable_scope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.has_variable_scope" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines whether the given object has a variable scope.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.log_variables">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">log_variables</code><span class="sig-paren">(</span><em>variables=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#log_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.log_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs variable information.</p>
<p>This function logs the name, shape, type, collections, and device for
either all variables or a given iterable of variables.</p>
<p>Args: variables: iterable of variables; if not provided, then all
variables (in the default graph) are logged.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.name_for_callable">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">name_for_callable</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#name_for_callable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.name_for_callable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a module name for a callable or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no name can be
found.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.reuse_variables">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">reuse_variables</code><span class="sig-paren">(</span><em>method</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#reuse_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.reuse_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps an arbitrary method so it does variable sharing.</p>
<p>This decorator creates variables the first time it calls <code class="docutils literal notranslate"><span class="pre">method</span></code>, and
reuses them for subsequent calls. The object that calls <code class="docutils literal notranslate"><span class="pre">method</span></code>
provides a <code class="docutils literal notranslate"><span class="pre">tf.VariableScope</span></code>, either as a <code class="docutils literal notranslate"><span class="pre">variable_scope</span></code>
attribute or as the return value of an <code class="docutils literal notranslate"><span class="pre">_enter_variable_scope()</span></code>
method.</p>
<p>The first time the wrapped method is invoked, it enters the caller’s
<code class="docutils literal notranslate"><span class="pre">tf.VariableScope</span></code> with <code class="docutils literal notranslate"><span class="pre">reuse=False</span></code>. On all subsequent calls it
enters the same variable scope with <code class="docutils literal notranslate"><span class="pre">reuse=True</span></code>.</p>
<p>Variables are created in the context of the <code class="docutils literal notranslate"><span class="pre">tf.VariableScope</span></code>
provided by the caller object. Ops are created with an additional
<code class="docutils literal notranslate"><span class="pre">tf.name_scope()</span></code>, which adds a scope for the wrapped method name. For
example:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">variable_scope</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span> <span class="k">as</span> <span class="n">variable_scope</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">variable_scope</span> <span class="o">=</span> <span class="n">variable_scope</span>

  <span class="nd">@snt</span><span class="o">.</span><span class="n">reuse_variables</span>
  <span class="k">def</span> <span class="nf">add_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tensor</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">tensor</span><span class="o">.</span><span class="n">get_shape</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">tensor</span> <span class="o">+</span> <span class="n">x</span>

<span class="n">module</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">(</span><span class="s2">&quot;my_module_name&quot;</span><span class="p">)</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,))</span>

<span class="c1"># This creates the variable &quot;my_module_name/x&quot;</span>
<span class="c1"># and op &quot;my_module_name/add_x/add&quot;</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">add_x</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</pre></div>
</div>
<p>Args: method: The method to wrap.</p>
<p>Returns: The wrapped method.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.to_snake_case">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">to_snake_case</code><span class="sig-paren">(</span><em>camel_case</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#to_snake_case"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.to_snake_case" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a CamelCase string as a snake_case string.</p>
</dd></dl>

<dl class="function">
<dt id="sonnet.python.modules.util.variable_map_items">
<code class="descclassname">sonnet.python.modules.util.</code><code class="descname">variable_map_items</code><span class="sig-paren">(</span><em>variable_map</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sonnet/python/modules/util.html#variable_map_items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sonnet.python.modules.util.variable_map_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields an iterator over (string, variable) pairs in the variable map.</p>
<p>In general, variable maps map variable names to either a
<code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>, or list of <code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>s (in case of sliced
variables).</p>
<p>Args: variable_map: dict, variable map over which to iterate.</p>
<p>Yields: (string, tf.Variable) pairs.</p>
</dd></dl>

</div>
<div class="section" id="sonnet-python-modules-util-test-module">
<h2>sonnet.python.modules.util_test module<a class="headerlink" href="#sonnet-python-modules-util-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sonnet.python.modules">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-sonnet.python.modules" title="Permalink to this headline">¶</a></h2>
<p>Sonnet Modules in TensorFlow.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">sonnet.python.modules package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.attention">sonnet.python.modules.attention module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-attention-test-module">sonnet.python.modules.attention_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.base">sonnet.python.modules.base module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.base_errors">sonnet.python.modules.base_errors module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.base_info">sonnet.python.modules.base_info module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-base-info-test-module">sonnet.python.modules.base_info_test module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-base-test-module">sonnet.python.modules.base_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.basic">sonnet.python.modules.basic module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.basic_rnn">sonnet.python.modules.basic_rnn module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-basic-rnn-test-module">sonnet.python.modules.basic_rnn_test module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-basic-test-module">sonnet.python.modules.basic_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.batch_norm">sonnet.python.modules.batch_norm module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-batch-norm-test-module">sonnet.python.modules.batch_norm_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.batch_norm_v2">sonnet.python.modules.batch_norm_v2 module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-batch-norm-v2-test-module">sonnet.python.modules.batch_norm_v2_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.block_matrix">sonnet.python.modules.block_matrix module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-block-matrix-test-module">sonnet.python.modules.block_matrix_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.clip_gradient">sonnet.python.modules.clip_gradient module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-clip-gradient-test-module">sonnet.python.modules.clip_gradient_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.conv">sonnet.python.modules.conv module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-conv-gpu-test-module">sonnet.python.modules.conv_gpu_test module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-conv-test-module">sonnet.python.modules.conv_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.embed">sonnet.python.modules.embed module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-embed-test-module">sonnet.python.modules.embed_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.experimental">sonnet.python.modules.experimental module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.gated_rnn">sonnet.python.modules.gated_rnn module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-gated-rnn-test-module">sonnet.python.modules.gated_rnn_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.layer_norm">sonnet.python.modules.layer_norm module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-layer-norm-test-module">sonnet.python.modules.layer_norm_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.pondering_rnn">sonnet.python.modules.pondering_rnn module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-pondering-rnn-test-module">sonnet.python.modules.pondering_rnn_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.residual">sonnet.python.modules.residual module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-residual-test-module">sonnet.python.modules.residual_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.rnn_core">sonnet.python.modules.rnn_core module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-rnn-core-test-module">sonnet.python.modules.rnn_core_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.scale_gradient">sonnet.python.modules.scale_gradient module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-scale-gradient-test-module">sonnet.python.modules.scale_gradient_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.sequential">sonnet.python.modules.sequential module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-sequential-test-module">sonnet.python.modules.sequential_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.spatial_transformer">sonnet.python.modules.spatial_transformer module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-spatial-transformer-test-module">sonnet.python.modules.spatial_transformer_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules.util">sonnet.python.modules.util module</a></li>
<li><a class="reference internal" href="#sonnet-python-modules-util-test-module">sonnet.python.modules.util_test module</a></li>
<li><a class="reference internal" href="#module-sonnet.python.modules">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/sonnet.python.modules.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Sonnet Authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/api/sonnet.python.modules.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>